<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Wizard ‚Äì AI Data-Engineer Demo</title>
  <meta name="description" content="Watch the Data Wizard agent map your warehouse, analyse costs & complexity, and chat like a senior data-engineer ‚Äì all in one live page.">
  <meta name="theme-color" content="#0d1117">

  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>

  <style>
    html { scroll-behavior: smooth; }
    body { font-family: 'Inter', sans-serif; }
    .bg-aurora { background: #0d1117; background-image: radial-gradient(ellipse at top, rgba(167, 139, 250, .12), transparent 55%), radial-gradient(ellipse at bottom, rgba(103, 232, 249, .12), transparent 55%), linear-gradient(rgba(255, 255, 255, .04) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, .04) 1px, transparent 1px); background-size: 100% 100%, 100% 100%, 2.5rem 2.5rem, 2.5rem 2.5rem; }
    .gradient-text { background: linear-gradient(to right, #a78bfa, #67e8f9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    @keyframes bob { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    .typing-indicator span { height: 8px; width: 8px; margin: 0 2px; background-color: #9ca3af; border-radius: 50%; display: inline-block; animation: bob 1.4s infinite ease-in-out; }
    .typing-indicator span:nth-child(1) { animation-delay: -.32s; }
    .typing-indicator span:nth-child(2) { animation-delay: -.16s; }
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #4b5563; border-radius: 6px; }
    /* Ensure immersive view takes full screen and is scrollable internally */
    .immersive-container {
        position: fixed;
        top: 4rem; /* Height of header */
        right: 0;
        left: 0;
        bottom: 0;
        overflow-y: auto;
    }
    html.immersive-active {
        overflow: hidden;
    }
  </style>
</head>
<body class="bg-aurora text-gray-200 antialiased" x-data="wizardPage()" x-init="init()">

  <header class="fixed top-0 inset-x-0 z-50 bg-gray-900/60 backdrop-blur-lg border-b border-gray-700/40 h-16">
    <nav class="container mx-auto px-4 sm:px-6 h-full flex justify-between items-center">
      <a href="#" class="text-xl font-extrabold gradient-text">üîÆ Data Wizard</a>
      <button @click="enterImmersive()" class="bg-purple-500 hover:bg-purple-400 text-white font-semibold py-2 px-5 rounded-lg transition-transform hover:scale-105 shadow-lg shadow-purple-500/20 text-sm sm:text-base">
        Start Interactive Demo
      </button>
    </nav>
  </header>

  <div class="pt-16"> <section x-show="!immersive" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="pt-16 md:pt-24 text-center overflow-hidden select-none">
      <div class="container mx-auto px-4 sm:px-6">
        <span class="bg-purple-500/10 border border-purple-500/30 text-purple-300 text-xs font-semibold px-4 py-1 rounded-full">
          AI-Powered Data-Engineering Companion
        </span>
        <h1 class="text-4xl md:text-6xl font-extrabold text-white mt-6 mb-4 leading-tight">
          Optimise your <span class="gradient-text">Data Warehouse</span><br>without lifting a finger
        </h1>
        <p class="text-lg md:text-xl text-gray-400 max-w-3xl mx-auto">
          See Data Wizard discover schemas, predict cost savings & answer deep engineering questions ‚Äì in minutes.
        </p>
        <div class="mt-10 flex justify-center gap-4 flex-wrap">
          <button @click="enterImmersive()" class="bg-purple-500 hover:bg-purple-400 text-white font-bold py-3 px-8 rounded-lg transition-transform hover:scale-105 text-lg shadow-lg shadow-purple-500/30">üöÄ Launch Demo</button>
          <a href="#features" class="inline-flex items-center gap-2 border border-gray-600 hover:bg-gray-800 px-6 py-3 rounded-lg transition-colors"> <i class="fa-solid fa-list-check text-purple-300"></i> See Features </a>
        </div>
      </div>
    </section>

    <section id="features" x-show="!immersive" x-transition class="py-20 bg-gray-900/40 mt-16">
      <div class="container mx-auto px-4 sm:px-6 text-center">
        <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Built for Data Engineers</h2>
        <p class="text-gray-400 max-w-2xl mx-auto mb-16">Automatic lineage, cost insights & query linting ‚Äì right out of the box.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 text-left">
          <template x-for="feat in features" :key="feat.title">
            <div class="bg-gray-800/60 p-6 rounded-xl border border-gray-700 hover:border-purple-500 transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-purple-500/10">
              <div class="text-3xl mb-4 text-purple-400"><i :class="feat.icon"></i></div>
              <h3 class="text-xl font-bold text-white mb-2" x-text="feat.title"></h3>
              <p class="text-gray-400" x-text="feat.desc"></p>
            </div>
          </template>
        </div>
      </div>
    </section>

    <main id="demo" x-show="immersive" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="immersive-container bg-gray-800/30" x-data="demoWizard()" x-init="start()">

      <template x-if="phase==='mapping'">
        <section class="h-full flex flex-col items-center justify-center text-center gap-6 px-4">
          <h2 class="text-2xl font-bold text-white">üîç Scanning & Mapping Warehouse‚Ä¶</h2>
          <p class="text-purple-300 h-5" x-text="status"></p>
          <div class="w-full max-w-xl bg-gray-900 rounded-full h-3.5 overflow-hidden border border-gray-700">
            <div class="h-full bg-gradient-to-r from-cyan-400 to-purple-500 transition-all duration-500 ease-out" :style="`width:${progress}%`"></div>
          </div>
        </section>
      </template>

      <template x-if="phase==='warehouse'">
        <section class="h-full flex flex-col md:flex-row gap-4 p-4">
          <aside class="w-full md:w-72 lg:w-80 bg-gray-900/60 border border-gray-700 rounded-xl p-4 flex flex-col shrink-0">
            <h3 class="font-bold text-white mb-3 text-lg">Identified Tables</h3>
            <input x-model="filterTerm" placeholder="Search tables‚Ä¶" class="bg-gray-800/50 mb-3 text-gray-200 placeholder-gray-400 border border-gray-700 rounded-md px-3 py-2 text-sm focus:outline-none focus:border-purple-400 ring-1 ring-transparent focus:ring-purple-500 w-full">
            <div class="flex-1 overflow-y-auto scrollbar-thin space-y-1">
              <template x-for="table in filteredTables" :key="table.name">
                <button @click="selectTable(table)" class="w-full flex justify-between items-center text-left px-3 py-2 rounded-md hover:bg-gray-800/50 transition" :class="{'bg-purple-600/40 text-white':selectedTable?.name===table.name}">
                  <span class="font-medium" x-text="table.name"></span>
                  <span class="text-xs text-gray-400" x-text="table.columns.length + ' cols'"></span>
                </button>
              </template>
            </div>
          </aside>

          <div class="flex-1 bg-gray-900/60 border border-gray-700 rounded-xl p-4 md:p-6 flex flex-col min-w-0 relative">
            <template x-if="!selectedTable">
              <div class="flex items-center justify-center h-full text-gray-500 text-center">
                <span><i class="fa-solid fa-arrow-left fa-lg mr-2"></i> Select a table from the list to get started</span>
              </div>
            </template>

            <template x-if="selectedTable">
              <div class="flex flex-col h-full">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-6">
                  <h3 class="text-xl lg:text-2xl font-bold text-white" x-text="selectedTable.name"></h3>
                  <div class="text-sm text-gray-400 flex flex-wrap gap-x-4 gap-y-1">
                    <span>Size: <span class="text-purple-300 font-semibold" x-text="selectedTable.sizeGB + ' GB'"></span></span>
                    <span>30-day cost: <span class="text-purple-300 font-semibold" x-text="'$'+selectedTable.last30Cost.toLocaleString()"></span></span>
                  </div>
                </div>

                <div class="grid lg:grid-cols-2 gap-6 flex-1 min-h-0">
                  <div class="overflow-y-auto pr-2 scrollbar-thin text-sm flex flex-col">
                      <h4 class="font-semibold text-gray-300 mb-2 text-base">Columns</h4>
                      <table class="w-full text-left">
                          <thead><tr class="text-purple-300 text-xs"><th class="pb-1 font-semibold pl-2">Column Name</th><th class="font-semibold">Type</th></tr></thead>
                          <tbody>
                              <template x-for="col in selectedTable.columns" :key="col.name">
                                  <tr class="border-t border-gray-700/50"><td class="py-1.5 pl-2" x-text="col.name"></td><td class="text-gray-400" x-text="col.type"></td></tr>
                              </template>
                          </tbody>
                      </table>

                      <h4 class="font-semibold text-gray-300 mt-6 mb-2 text-base">Relationships</h4>
                      <template x-if="selectedTable.relations.length === 0"><p class="text-xs text-gray-500">No foreign keys detected.</p></template>
                      <div class="space-y-1">
                        <template x-for="rel in selectedTable.relations" :key="rel.toTable">
                            <div class="text-xs text-gray-400 bg-gray-800/50 rounded p-2 border border-gray-700" x-text="`${selectedTable.name}.${rel.from} ‚ûú ${rel.toTable}.${rel.to}`"></div>
                        </template>
                      </div>
                  </div>

                  <div class="bg-gray-800/60 p-4 rounded-lg border border-gray-700/80 flex flex-col min-h-[250px] lg:min-h-0">
                    <h4 class="font-semibold text-gray-300 mb-2 text-base">Monthly Cost Trend</h4>
                    <div class="relative flex-1">
                        <canvas :id="'chart-'+selectedTable.name" class="!h-full !w-full"></canvas>
                    </div>
                  </div>
                </div>

                <div class="flex justify-center mt-6">
                    <button @click="phase='chat'; initPreQ(); $nextTick(() => scrollToBottom())" class="bg-purple-500 hover:bg-purple-400 text-white font-semibold px-6 py-2 rounded-full shadow-lg shadow-purple-500/20 transition-transform hover:scale-105">
                        üí¨ Chat with Agent
                    </button>
                </div>
              </div>
            </template>
          </div>
        </section>
      </template>

      <template x-if="phase==='chat'">
        <section class="h-full flex flex-col bg-gray-900/40">
          <div class="flex items-center justify-between px-4 h-14 border-b border-gray-700 bg-gray-900/60 shrink-0">
            <button @click="phase='warehouse'" class="text-gray-300 hover:text-white text-sm"><i class="fa-solid fa-arrow-left mr-2"></i>Back</button>
            <h2 class="font-semibold text-white text-sm">Data-Engineer Agent</h2>
            <div class="w-12"></div> </div>

          <div id="chatArea" class="flex-1 overflow-y-auto p-4 space-y-6 scrollbar-thin">
            <template x-for="msg in messages" :key="msg.id">
              <div class="flex" :class="msg.who==='user'?'justify-end':'justify-start'">
                <div class="max-w-[90%] sm:max-w-[80%] md:max-w-[70%]">
                  <div :class="msg.who==='user'?'bg-purple-600 text-white rounded-br-none':'bg-gray-800 text-gray-200 rounded-bl-none'" class="px-4 py-2.5 rounded-xl whitespace-pre-wrap text-sm" x-html="msg.text"></div>
                </div>
              </div>
            </template>
            <div x-show="isTyping" class="flex justify-start">
              <div class="bg-gray-800 text-gray-200 rounded-xl rounded-bl-none px-4 py-2">
                <div class="typing-indicator"><span></span><span></span><span></span></div>
              </div>
            </div>
          </div>

          <div x-show="suggested.length" class="border-t border-gray-700 bg-gray-900/50 p-3 text-xs">
            <p class="text-gray-400 mb-2">Suggestions:</p>
            <div class="flex flex-wrap gap-2">
              <template x-for="q in suggested" :key="q">
                <button @click="quickAsk(q)" class="bg-gray-800 hover:bg-purple-500 hover:text-white border border-gray-700 text-gray-300 px-3 py-1.5 rounded-full transition text-left">üéØ <span x-text="q"></span></button>
              </template>
            </div>
          </div>

          <div class="border-t border-gray-700 bg-gray-900/50 p-3 flex items-start sm:items-center gap-3 shrink-0">
            <textarea x-model="chatInput" @keydown.enter.prevent.stop="sendMsg()" placeholder="Ask about costs, schema health, query anti-patterns‚Ä¶" class="flex-1 bg-gray-800 text-gray-200 rounded-md px-3 py-2 resize-none h-10 focus:outline-none focus:ring-2 focus:ring-purple-500 border border-gray-700 text-sm" @input="chatInput.style.height = 'auto'; chatInput.style.height = chatInput.scrollHeight + 'px'"></textarea>
            <button @click="sendMsg()" :disabled="!chatInput.trim()" class="bg-purple-500 hover:bg-purple-400 disabled:opacity-40 disabled:cursor-not-allowed text-white font-semibold px-5 py-2 rounded-md transition self-end sm:self-center">Send</button>
          </div>
        </section>
      </template>

    </main>

    <footer x-show="!immersive" class="bg-gray-900/50 border-t border-gray-700/40 py-10 text-center text-gray-500">
      <p>&copy; <span x-text="year"></span> BI Magics. All rights reserved.</p>
      <p class="text-xs mt-2">Built with ü™Ñ for data-engineering teams</p>
    </footer>
  </div>

<script>
function wizardPage() {
  return {
    immersive: false,
    year: new Date().getFullYear(),
    features: [
      { icon: 'fa-solid fa-sack-dollar', title: 'Cost Analysis', desc: 'Estimate storage & query cost per table, plus optimisation hints.' },
      { icon: 'fa-solid fa-code-compare', title: 'SQL Complexity Scanner', desc: 'Rank queries by CTE depth, join count & anti-patterns.' },
      { icon: 'fa-solid fa-project-diagram', title: 'Visual Lineage Graph', desc: 'A map of dependencies & field-level lineage.' },
      { icon: 'fa-solid fa-shield-heart', title: 'Schema Health', desc: 'Detect orphan tables, missing PK/FKs & skewed distributions.' },
      { icon: 'fa-solid fa-user-lock', title: 'Permission Analysis', desc: 'Highlight overly-broad access or potential security risks.' },
      { icon: 'fa-solid fa-bell', title: 'Anomaly Alerts', desc: 'Spot sudden cost spikes or query degradation.' }
    ],
    enterImmersive() {
      this.immersive = true;
      document.documentElement.classList.add('immersive-active');
    },
    init() {
        // AlpineJS will call this on component initialization.
    }
  }
}

function demoWizard() {
  return {
    phase: 'mapping',
    progress: 0,
    status: 'Initializing‚Ä¶',
    filterTerm: '',
    selectedTable: null,
    chatInput: '',
    messages: [],
    msgId: 0,
    suggested: [],
    isTyping: false,
    demoData: {
      tables: [
        { name: 'events_log', sizeGB: 125.7, last30Cost: 38400, columns: [{ name: 'event_id', type: 'STRING' }, { name: 'user_id', type: 'INT' }, { name: 'event_name', type: 'STRING' }, { name: 'event_time', type: 'TIMESTAMP' }, { name: 'platform', type: 'STRING' }], relations: [{ from: 'user_id', to: 'id', toTable: 'users_profiles' }], monthlyCosts: [27000, 27800, 31100, 34300, 38200, 38400] },
        { name: 'users_profiles', sizeGB: 12.4, last30Cost: 3100, columns: [{ name: 'id', type: 'INT' }, { name: 'email', type: 'STRING' }, { name: 'created_at', type: 'TIMESTAMP' }, { name: 'country_code', type: 'STRING' }], relations: [{ from: 'id', to: 'user_id', toTable: 'events_log' }, { from: 'id', to: 'user_id', toTable: 'payments_records' }], monthlyCosts: [2800, 3100, 2900, 3000, 3100, 3050] },
        { name: 'payments_records', sizeGB: 8.2, last30Cost: 2200, columns: [{ name: 'payment_id', type: 'STRING' }, { name: 'user_id', type: 'INT' }, { name: 'amount_usd', type: 'NUMERIC' }, { name: 'paid_at', type: 'TIMESTAMP' }], relations: [{ from: 'user_id', to: 'id', toTable: 'users_profiles' }], monthlyCosts: [1600, 1800, 1950, 2200, 2150, 2200] },
        { name: 'marketing_campaigns', sizeGB: 1.5, last30Cost: 150, columns: [{ name: 'campaign_id', type: 'STRING' }, { name: 'name', type: 'STRING' }, { name: 'start_date', type: 'DATE' }], relations: [], monthlyCosts: [100, 120, 150, 140, 160, 150] },
        { name: 'orphan_table_tmp', sizeGB: 0.8, last30Cost: 5, columns: [{ name: 'dummy_col', type: 'STRING' }, { name: 'notes', type: 'STRING' }], relations: [], monthlyCosts: [5, 5, 5, 5, 5, 5] }
      ]
    },
    get filteredTables() { if (!this.filterTerm) return this.demoData.tables; const term = this.filterTerm.toLowerCase(); return this.demoData.tables.filter(t => t.name.toLowerCase().includes(term)) },
    start() {
      const steps = ['Scanning tables‚Ä¶', 'Discovering PK/FK relationships‚Ä¶', 'Computing lineage‚Ä¶', 'Estimating costs‚Ä¶', 'Generating insights‚Ä¶', 'Finalizing report‚Ä¶'];
      steps.forEach((txt, i) => setTimeout(() => { this.status = txt; this.progress = Math.round(((i + 1) / steps.length) * 100) }, i * 700));
      setTimeout(() => {
        this.phase = 'warehouse';
        this.$nextTick(() => {
            this.selectTable(this.demoData.tables[0]);
        });
      }, steps.length * 700 + 300);
    },
    selectTable(t) {
        this.selectedTable = t;
        const id = 'chart-' + t.name;
        const oldChart = Chart.getChart(id);
        if (oldChart) {
            oldChart.destroy();
        }
        this.$nextTick(() => this.renderCostChart(t, id));
    },
    renderCostChart(t, canvasId) {
        const ctx = document.getElementById(canvasId);
        if (!ctx) return;
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['-5 mo', '-4 mo', '-3 mo', '-2 mo', 'Last Mo', 'This Mo'],
                datasets: [{
                    label: 'Monthly Cost',
                    data: t.monthlyCosts,
                    borderColor: '#a78bfa',
                    backgroundColor: 'rgba(167, 139, 250, .18)',
                    fill: true,
                    tension: 0.4,
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { display: false },
                        grid: { color: 'rgba(255, 255, 255, .05)' }
                    },
                    x: {
                        ticks: {
                            display: true,
                            color: '#9ca3af',
                            font: { size: 10 }
                        },
                        grid: { display: false }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index',
                },
                tooltips: {
                    enabled: true
                }
            }
        });
    },
    initPreQ() {
      this.messages.push({id: ++this.msgId, who: 'bot', text: 'Hello! I am the Data Wizard agent. How can I help you today?'});
      this.suggested = [
          'What are the 3 costliest tables?',
          'Find orphan tables not queried in the last 90 days',
          'Suggest clustering keys for the events_log table',
          'Detect anti-patterns in our SQL views',
          'Estimate savings if we partition payments by date'
      ];
    },
    quickAsk(q) {
      this.chatInput = q;
      this.sendMsg();
    },
    sendMsg() {
      if (!this.chatInput.trim()) return;
      const txt = this.chatInput.trim();
      this.messages.push({ id: ++this.msgId, who: 'user', text: txt });
      this.chatInput = '';
      this.suggested = [];
      this.isTyping = true;
      this.scrollToBottom();
      setTimeout(() => {
        this.botRespond(txt);
        this.isTyping = false;
        this.scrollToBottom();
      }, 1200 + Math.random() * 600);
    },
    botRespond(q) {
      const lq = q.toLowerCase();
      let ans = '';
      if (lq.includes('costliest') || lq.includes('cost')) {
        ans = '<strong>Top 3 Costliest Tables (last 30 days):</strong>\n1. <code>events_log</code> ‚Äî $38,400\n2. <code>users_profiles</code> ‚Äî $3,100\n3. <code>payments_records</code> ‚Äî $2,200\n\n<span class="gradient-text">üí° Recommendation:</span> You can save ~25% on scan costs in the <code>events_log</code> table by adding clustering on the <code>platform</code> and <code>DATE(event_time)</code> columns.';
      } else if (lq.includes('orphan')) {
        ans = 'I have identified one table that appears to be an orphan:\n‚Ä¢ <code>orphan_table_tmp</code> (Size: 0.8 GB, Cost: $5)\n\nThis table has no relationships and I could not find any queries referencing it in the last 90 days. It is recommended to verify it is unused and consider dropping it to save on storage costs.';
      } else if (lq.includes('anti-pattern') || lq.includes('anti-patterns')) {
        ans = 'I scanned the views in your warehouse and found several common anti-patterns:\n\n‚Ä¢ <strong>In <code>vw_user_revenue</code> view:</strong> Use of <code>SELECT *</code> which makes optimization difficult, and a <code>LEFT JOIN</code> that produces a large number of NULL values, making queries more expensive.\n‚Ä¢ <strong>In <code>vw_daily_events</code> view:</strong> I identified an expensive subquery that does not affect the final result.\n\nFixing these patterns can significantly improve query performance and lower costs.';
      } else if (lq.includes('cluster') || lq.includes('clustering')) {
        ans = 'Certainly. For the <code>events_log</code> table (~125GB), I recommend setting a composite clustering key:\n\n<code>CLUSTER BY (platform, DATE(event_time))</code>\n\n<strong>Rationale:</strong><br>1. <strong>Platform:</strong> Most queries likely filter by platform (e.g., web, mobile).<br>2. <strong>DATE(event_time):</strong> Many analyses are based on date ranges.\n\nThis combination will efficiently organize the physical data and dramatically reduce the amount of data scanned in common queries, with an estimated savings of <strong>25%-40%</strong> on processing costs.';
      } else {
        ans = 'I\'ve identified an optimization opportunity in the <code>users_profiles</code> table. Adding a filter on the <code>country_code</code> column when querying can reduce scanned data by over 85% for geo-targeted queries. Would you like me to show a code example?';
      }
      this.messages.push({ id: ++this.msgId, who: 'bot', text: ans });
    },
    scrollToBottom() {
      this.$nextTick(() => {
        const area = document.getElementById('chatArea');
        if (area) {
            area.scrollTo({ top: area.scrollHeight, behavior: 'smooth' });
        }
      });
    }
  }
}
</script>

</body>
</html>
