<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Wizard ‚Äì AI Data Engineer Demo</title>
  <meta name="description" content="Watch the Data Wizard agent map your warehouse, analyse costs & complexity, and chat like a senior data-engineer ‚Äì all in one live page.">
  <meta name="theme-color" content="#0d1117">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
    
    /* Enhanced background with a radial gradient for depth and focus */
    .bg-aurora { 
      background-color: #0d1117; 
      background-image: 
        radial-gradient(ellipse at top, rgba(167, 139, 250, 0.1), transparent 50%),
        radial-gradient(ellipse at bottom, rgba(103, 232, 249, 0.1), transparent 50%),
        linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), 
        linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px); 
      background-size: 100% 100%, 100% 100%, 2.5rem 2.5rem, 2.5rem 2.5rem;
    }
    
    .gradient-text { background: linear-gradient(to right, #a78bfa, #67e8f9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #4b5563; border-radius: 6px; }

    /* Typing indicator for chat to feel more alive */
    .typing-indicator span {
        height: 8px; width: 8px; margin: 0 2px;
        background-color: #9ca3af; border-radius: 50%;
        display: inline-block;
        animation: bob 1.4s infinite ease-in-out;
    }
    .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
    .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bob {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1.0); }
    }
  </style>
</head>
<body class="bg-aurora text-gray-200 antialiased">
  <header class="sticky top-0 z-50 bg-gray-900/60 backdrop-blur-lg border-b border-gray-700/50">
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
      <a href="#" class="text-2xl font-bold gradient-text">üîÆ Data Wizard</a>
      <a href="#live-demo" class="bg-purple-500 hover:bg-purple-400 text-white font-bold py-2 px-5 rounded-lg transition-transform hover:scale-105 shadow-lg shadow-purple-500/20">Start Interactive Demo</a>
    </nav>
  </header>

  <section class="py-24 md:py-32 text-center overflow-hidden">
    <div class="container mx-auto px-6">
      <span class="bg-purple-500/10 border border-purple-500/30 text-purple-300 text-sm font-semibold px-4 py-1 rounded-full">
        AI-Powered Data Engineering Companion
      </span>
      <h1 class="text-4xl md:text-6xl font-extrabold text-white mt-6 mb-4 leading-tight">
        Optimise your <span class="gradient-text">Data Warehouse</span><br>Without lifting a finger
      </h1>
      <p class="text-lg md:text-xl text-gray-400 max-w-3xl mx-auto">
        See Data Wizard discover schemas, predict cost savings & answer deep engineering questions ‚Äì in minutes.
      </p>
      <div class="mt-10 flex justify-center gap-4 flex-wrap">
        <a href="#live-demo" class="bg-purple-500 hover:bg-purple-400 text-white font-bold py-3 px-8 rounded-lg transition-transform hover:scale-105 text-lg shadow-lg shadow-purple-500/30">üöÄ Launch Demo</a>
        <a href="#features" class="inline-flex items-center gap-2 border border-gray-600 hover:bg-gray-800 px-6 py-3 rounded-lg transition-colors"> <i class="fa-solid fa-list-check text-purple-300"></i> Deep-Dive Features </a>
      </div>
    </div>
  </section>

  <section id="features" class="py-20 bg-gray-900/40">
    <div class="container mx-auto px-6 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Built for Data Engineers</h2>
      <p class="text-gray-400 max-w-2xl mx-auto mb-16">Automatic lineage, cost insights & query linting ‚Äì right out of the box.</p>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 text-left">
        <template x-for="feat in [
            {icon:'fa-solid fa-sack-dollar', title:'Cost Analysis', desc:'Estimate storage & query cost per table, plus optimization hints.'},
            {icon:'fa-solid fa-code-compare', title:'SQL Complexity Scanner', desc:'Rank queries by CTE depth, join count, and anti-patterns.'},
            {icon:'fa-solid fa-project-diagram', title:'Visual Lineage Graph', desc:'A visual map of dependencies and field-level lineage.'},
            {icon:'fa-solid fa-shield-heart', title:'Schema Health', desc:'Detect orphan tables, missing PK/FKs, and skewed data distributions.'},
            {icon:'fa-solid fa-user-lock', title:'Permission Analysis', desc:'Highlight tables with overly-broad access or potential security risks.'},
            {icon:'fa-solid fa-bell', title:'Anomaly Alerts', desc:'Spot sudden cost spikes, volume anomalies, or query performance degradation.'}
        ]" :key="feat.title">
          <div class="bg-gray-800/60 p-6 rounded-xl border border-gray-700 hover:border-purple-500 transition-all hover:scale-105 hover:shadow-2xl hover:shadow-purple-500/10">
            <div class="text-3xl mb-4 text-purple-400"><i :class="feat.icon"></i></div>
            <h3 class="text-xl font-bold text-white mb-2" x-text="feat.title"></h3>
            <p class="text-gray-400" x-text="feat.desc"></p>
          </div>
        </template>
      </div>
    </div>
  </section>

  <section id="live-demo" class="py-24 bg-gray-800/30 border-t border-b border-gray-700/50" x-data="demoWizard()" x-init="startMapping()">
    <div x-show="phase==='mapping'" x-transition:enter="transition ease-out duration-500" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="container mx-auto px-6 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-8">üîç Scanning & Mapping Warehouse‚Ä¶</h2>
      <p class="text-purple-300 mb-6 h-6" x-text="status"></p>
      <div class="w-full max-w-2xl mx-auto bg-gray-900 rounded-full h-3.5 overflow-hidden border border-gray-700">
        <div class="h-full bg-gradient-to-r from-cyan-400 to-purple-500 transition-all duration-1000 ease-out" :style="`width:${progress}%`"></div>
      </div>
    </div>

    <div x-show="phase==='warehouse'" x-transition class="container mx-auto px-6">
      <div class="bg-gray-900/60 border border-gray-700/80 rounded-2xl p-4 md:p-6 backdrop-blur-sm shadow-2xl">
        <div class="grid md:grid-cols-4 gap-6">
          <div class="md:col-span-1 bg-gray-900/50 border border-gray-700 rounded-xl p-4 h-[500px] md:h-[600px] flex flex-col">
            <input x-model="filterTerm" placeholder="Search tables‚Ä¶" class="w-full bg-gray-800/50 mb-4 text-gray-200 placeholder-gray-400 border border-gray-700 rounded-md px-3 py-2 focus:outline-none focus:border-purple-400 ring-1 ring-transparent focus:ring-purple-500">
            <div class="flex-1 overflow-y-auto scrollbar-thin space-y-1">
              <template x-for="table in filteredTables" :key="table.name">
                <button @click="selectTable(table)" class="w-full flex justify-between items-center text-left px-3 py-2 rounded-md hover:bg-gray-800/50 transition-colors" :class="{'bg-purple-600/30 text-white': selectedTable?.name === table.name}">
                  <span class="font-semibold" x-text="table.name"></span>
                  <span class="text-xs text-gray-400" x-text="table.columns.length + ' cols'"></span>
                </button>
              </template>
            </div>
          </div>
          <div class="md:col-span-3">
             <div x-show="!selectedTable" class="flex items-center justify-center h-full text-gray-500">
                <p>‚Üê Select a table to get started</p>
             </div>
             <div x-show="selectedTable" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-x-4" x-transition:enter-end="opacity-100 translate-x-0" class="bg-gray-900/50 border border-gray-700 rounded-xl p-6 h-full">
              <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                <h3 class="text-2xl font-bold text-white" x-text="selectedTable?.name"></h3>
                <div class="text-sm text-gray-400 mt-2 md:mt-0">
                  Size: <span class="text-purple-300 font-semibold" x-text="selectedTable?.sizeGB + ' GB'"></span> ‚Ä¢ 30-day cost: <span class="text-purple-300 font-semibold" x-text="'$' + selectedTable?.last30Cost.toLocaleString()"></span>
                </div>
              </div>
              <div class="grid lg:grid-cols-2 gap-6">
                <div class="text-sm">
                  <table class="w-full text-left">
                    <thead><tr class="text-purple-300"><th class="pb-2 font-semibold">Column</th><th class="font-semibold">Type</th></tr></thead>
                    <tbody>
                      <template x-for="col in selectedTable?.columns" :key="col.name">
                        <tr class="border-t border-gray-700/50"><td class="py-1.5" x-text="col.name"></td><td class="text-gray-400" x-text="col.type"></td></tr>
                      </template>
                    </tbody>
                  </table>
                  <h4 class="font-semibold text-gray-300 mt-6 mb-2">Relationships</h4>
                  <div class="text-xs space-y-1">
                    <template x-if="selectedTable?.relations.length === 0"><p class="text-gray-500">No foreign keys detected.</p></template>
                    <template x-for="rel in selectedTable?.relations" :key="rel.toTable">
                      <div class="text-gray-400" x-text="selectedTable.name + '.' + rel.from + ' ‚ûú ' + rel.toTable + '.' + rel.to"></div>
                    </template>
                  </div>
                </div>
                <div class="bg-gray-800/60 p-4 rounded-lg border border-gray-700/80">
                  <canvas x-show="selectedTable" :id="'chart-'+selectedTable?.name"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="text-center mt-12">
        <button @click="phase='chat'; initPreQ();" class="bg-purple-500 hover:bg-purple-400 text-white font-bold px-8 py-3 rounded-lg transition-transform hover:scale-105 text-lg shadow-lg shadow-purple-500/30">üí¨ Ask the Agent</button>
      </div>
    </div>

    <div x-show="phase==='chat'" x-transition class="container mx-auto px-6 max-w-4xl">
       <div class="bg-gray-900/60 border border-gray-700/80 rounded-2xl backdrop-blur-sm shadow-2xl overflow-hidden">
        <div class="p-4 border-b border-gray-700 flex justify-between items-center">
            <button @click="phase='warehouse'" class="bg-gray-800 hover:bg-gray-700 text-gray-200 px-4 py-2 rounded-md transition-colors"><i class="fa-solid fa-arrow-left"></i> Back</button>
            <h2 class="text-xl font-bold text-white">Data Engineer Agent</h2>
            <span></span>
        </div>
        <div class="h-[60vh] md:h-[500px] overflow-y-auto p-4 space-y-6 scrollbar-thin" id="chatArea">
          <template x-for="msg in messages" :key="msg.id">
            <div class="flex" :class="msg.who==='user' ? 'justify-end' : 'justify-start'">
              <div class="max-w-[85%] md:max-w-[75%]">
                <div :class="msg.who==='user' ? 'bg-purple-600 text-white rounded-br-none' : 'bg-gray-800 text-gray-200 rounded-bl-none'" class="px-4 py-3 rounded-xl whitespace-pre-wrap" x-html="msg.text"></div>
              </div>
            </div>
          </template>
          <div x-show="isTyping" class="flex justify-start">
              <div class="bg-gray-800 text-gray-200 rounded-xl rounded-bl-none px-4 py-3">
                  <div class="typing-indicator"><span></span><span></span><span></span></div>
              </div>
          </div>
        </div>
        <div class="p-4 border-t border-b border-gray-700" x-show="suggested.length">
          <p class="text-sm text-gray-400 mb-2">Suggestions:</p>
          <div class="flex flex-wrap gap-2">
            <template x-for="(q,idx) in suggested" :key="idx">
              <button @click="quickAsk(q)" class="bg-gray-800 hover:bg-purple-500 hover:text-white text-gray-300 text-sm px-3 py-1.5 rounded-full border border-gray-700 transition-colors">üéØ <span x-text="q"></span></button>
            </template>
          </div>
        </div>
        <div class="p-4 flex items-center bg-gray-900/50">
          <textarea x-model="chatInput" @keydown.enter.prevent="sendMsg()" placeholder="Ask about costs, schema health, query anti-patterns‚Ä¶" class="flex-1 bg-gray-800 text-gray-200 rounded-md px-3 py-2 resize-none h-12 focus:outline-none focus:ring-2 focus:ring-purple-500 border border-gray-700"></textarea>
          <button @click="sendMsg()" class="ml-3 bg-purple-500 hover:bg-purple-400 text-white font-bold px-6 py-2 rounded-md disabled:opacity-40 disabled:cursor-not-allowed transition-all" :disabled="!chatInput.trim()">Send</button>
        </div>
      </div>
    </div>
  </section>

  <footer class="bg-gray-900/50 border-t border-gray-700/50 mt-24">
    <div class="container mx-auto px-6 py-8 text-center text-gray-500">
      <p>&copy; <span id="year"></span> BI Magics. All rights reserved.</p>
      <p class="text-sm mt-2">Built with ü™Ñ for data-engineering teams</p>
    </div>
  </footer>

  <script>
  function demoWizard() {
    return {
      // Phase control & status
      phase: 'mapping', 
      progress: 0, 
      status: 'Starting‚Ä¶',
      
      // Warehouse explorer state
      filterTerm: '', 
      selectedTable: null,
      
      // Chat state
      chatInput: '', 
      messages: [], 
      msgId: 0,
      suggested: [],
      isTyping: false,
      
      // Demo data
      demoData: {
        tables: [
          { name:'users', sizeGB:12.4, last30Cost:3100, columns:[{name:'id',type:'INT'},{name:'email',type:'STRING'},{name:'created_at',type:'TIMESTAMP'},{name:'country',type:'STRING'}], relations:[{from:'id',to:'user_id',toTable:'events'}], monthlyCosts:[2800,3100,2900,3000,3100,3050] },
          { name:'events', sizeGB:85.7, last30Cost:28400, columns:[{name:'event_id',type:'STRING'},{name:'user_id',type:'INT'},{name:'event_name',type:'STRING'},{name:'event_time',type:'TIMESTAMP'}], relations:[{from:'user_id',to:'id',toTable:'users'}], monthlyCosts:[27000,27800,28100,28300,28200,28400] },
          { name:'payments', sizeGB:4.2, last30Cost:1200, columns:[{name:'payment_id',type:'STRING'},{name:'user_id',type:'INT'},{name:'amount',type:'NUMERIC'},{name:'paid_at',type:'TIMESTAMP'}], relations:[{from:'user_id',to:'id',toTable:'users'}], monthlyCosts:[1000,1100,1100,1200,1200,1200] },
          { name:'orphan_table_tmp', sizeGB:0.8, last30Cost:0, columns:[{name:'dummy',type:'STRING'}], relations:[], monthlyCosts:[0,0,0,0,0,0] }
        ]
      },
      
      // Computed properties
      get filteredTables() {
        if(!this.filterTerm) return this.demoData.tables;
        const term = this.filterTerm.toLowerCase();
        return this.demoData.tables.filter(t => t.name.toLowerCase().includes(term));
      },
      
      // Methods
      startMapping(){
        const steps=['Scanning tables‚Ä¶','Discovering PK/FK relationships‚Ä¶','Computing lineage‚Ä¶','Estimating costs‚Ä¶','Generating insights‚Ä¶', 'Finalizing report...'];
        steps.forEach((txt, i) => {
            setTimeout(() => {
                this.status = txt;
                this.progress = Math.round(((i + 1) / steps.length) * 100);
            }, i * 1000);
        });
        setTimeout(() => {
            this.phase = 'warehouse';
            this.progress = 100;
            this.$nextTick(() => this.selectTable(this.demoData.tables[1])); // Auto-select a table for immediate engagement
        }, steps.length * 1000 + 400);
      },
      
      selectTable(t){
        this.selectedTable = t;
        const chartId = 'chart-' + t.name;
        // Destroy old chart instance if it exists to prevent memory leaks and rendering issues
        const existingChart = Chart.getChart(chartId);
        if (existingChart) {
            existingChart.destroy();
        }
        this.$nextTick(() => this.renderCostChart(t, chartId));
      },
      
      renderCostChart(t, chartId){
        const ctx = document.getElementById(chartId);
        if(!ctx) return;
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['-5mo', '-4mo', '-3mo', '-2mo', 'Last Mo', 'This Mo'],
                datasets: [{
                    label: 'Monthly Cost',
                    data: t.monthlyCosts,
                    borderColor: '#a78bfa',
                    backgroundColor: 'rgba(167, 139, 250, 0.2)',
                    fill: true,
                    tension: 0.4,
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { 
                    y: { beginAtZero: true, ticks: { display: false }, grid: { color: 'rgba(255,255,255,0.05)' } },
                    x: { ticks: { display: false }, grid: { color: 'rgba(255,255,255,0.05)' } }
                }
            }
        });
      },
      
      // Chat methods
      initPreQ(){
        this.suggested=[
          'List top 3 costliest tables',
          'Find orphan tables not queried in 90 days',
          'Suggest clustering keys for the events table',
          'Detect anti-patterns in our SQL views',
          'Estimate savings if we partition payments by date'
        ];
      },
      
      quickAsk(q){ this.chatInput=q; this.sendMsg(); },
      
      sendMsg(){
        if(!this.chatInput.trim()) return;
        const userText = this.chatInput.trim();
        this.messages.push({ id: ++this.msgId, who: 'user', text: userText });
        this.chatInput = '';
        this.suggested = []; // Hide suggestions after asking
        this.isTyping = true;
        this.scrollToBottom();
        
        setTimeout(() => {
          this.botRespond(userText);
          this.isTyping = false;
          this.scrollToBottom();
        }, 1500 + Math.random() * 800); // Simulate network and thinking time
      },
      
      botRespond(q){
        let ans = '';
        const lq = q.toLowerCase();
        if(lq.includes('costliest') || lq.includes('cost')){
            ans = '<strong>Top Costly Tables (30-day):</strong>\n1. <code>events</code> ‚Äî $28,400\n2. <code>users</code> ‚Äî $3,100\n3. <code>payments</code> ‚Äî $1,200\n\n<span class="gradient-text">Recommendation:</span> Consider clustering the <code>events</code> table by <code>event_name</code> & date to save an estimated ~22% on query scans.';
        } else if(lq.includes('orphan')){
            ans = 'I\'ve identified one potentially orphan table:\n‚Ä¢ <code>orphan_table_tmp</code> (0.8 GB, $0 cost)\n\nThis table has not been queried in over 180 days. I recommend you <span class="gradient-text">verify with the relevant team before dropping it</span>.';
        } else if(lq.includes('anti-pattern')){
            ans = 'Certainly. I found 2 views with common anti-patterns:\n‚Ä¢ <code>user_revenue_v</code> ‚Äì Uses `SELECT *` and a `LEFT JOIN` that could introduce nulls unexpectedly.\n‚Ä¢ <code>daily_events_v</code> ‚Äì Contains an unused, expensive sub-query.\n\nRefactoring these will improve performance and readability.';
        } else if(lq.includes('clustering') || lq.includes('cluster')){
            ans = 'For the <code>events</code> table (~85GB), creating a clustering key on (<code>event_name</code>, DATE(<code>event_time</code>)) is estimated to reduce data scanned by up to 40% for common queries.';
        } else {
            ans = 'That\'s an excellent question. Here is a general optimization tip I found:\nAdding a partition filter on the <code>country</code> column when querying the <code>users</code> table can reduce scanned data by up to 85% for country-specific lookups.';
        }
        this.messages.push({id: ++this.msgId, who:'bot', text: ans});
      },

      scrollToBottom() {
        this.$nextTick(() => {
          const area = document.getElementById('chatArea');
          area.scrollTo({ top: area.scrollHeight, behavior: 'smooth' });
        });
      }
    }
  }
  document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
