<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>专 </title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS - 注爪 */
        :root {
            --correct-color: #6aaa64;
            --present-color: #c9b458;
            --absent-color: #787c7e;
            --key-bg: #d3d6da;
            --background-color: #f7f7f7;
            --text-color: #333;
        }

        body {
            font-family: 'Assistant', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            height: 100vh;
            margin: 0;
            -webkit-tap-highlight-color: transparent; /* 注  爪  */
        }

        header {
            text-align: center;
            border-bottom: 1px solid #ccc;
            width: 100%;
            padding: 10px 0;
        }

        header h1 {
            font-size: 2rem;
            margin: 0;
            color: var(--correct-color);
        }

        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            width: 100%;
            overflow: hidden;
        }

        #game-board {
            display: grid;
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            padding: 10px;
            box-sizing: border-box;
            width: 100%;
            max-width: 330px; /* 专 驻 */
            height: calc(100vw * 1.2); /*   */
            max-height: 400px;
        }

        .row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .tile {
            width: 100%;
            font-size: 2rem;
            font-weight: bold;
            text-transform: uppercase;
            border: 2px solid #d3d6da;
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
            transition: transform 0.2s, background-color 0.5s, border-color 0.5s;
            user-select: none;
        }

        .tile.filled {
            border-color: #999;
        }

        .tile.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
        }

        .tile.present {
            background-color: var(--present-color);
            color: white;
            border-color: var(--present-color);
        }

        .tile.absent {
            background-color: var(--absent-color);
            color: white;
            border-color: var(--absent-color);
        }

        /* 爪转 */
        .tile.pop {
            animation: pop 0.1s;
        }

        @keyframes pop {
            from { transform: scale(0.8); }
            to { transform: scale(1); }
        }

        .tile.flip {
            animation: flip 0.6s ease forwards;
        }

        @keyframes flip {
            0% { transform: rotateX(0); }
            50% { transform: rotateX(90deg); }
            100% { transform: rotateX(0); }
        }

        #keyboard {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 10px;
            width: 100%;
            max-width: 500px;
            box-sizing: border-box;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            gap: 6px;
        }

        .key {
            font-family: 'Assistant', sans-serif;
            font-weight: bold;
            background-color: var(--key-bg);
            color: var(--text-color);
            padding: 15px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            flex-grow: 1;
            font-size: 1rem;
            user-select: none;
            text-align: center;
            min-width: 20px; /* 专  驻转专 */
        }

        .key.large {
            flex-grow: 1.5;
            font-size: 0.8rem;
        }

        .key.correct { background-color: var(--correct-color); color: white; }
        .key.present { background-color: var(--present-color); color: white; }
        .key.absent { background-color: var(--absent-color); color: white; }

        #message-container {
            position: fixed;
            top: 15%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        #message-container.show {
            opacity: 1;
        }

        /* 转转 砖专 砖 */
        @media (max-width: 360px) {
            .key {
                padding: 12px 6px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>专  </h1>
    </header>
    <main>
        <div id="game-board"></div>
        <div id="message-container"></div>
    </main>
    <footer>
        <div id="keyboard"></div>
    </footer>

    <script>
    // JavaScript - 拽转 砖拽
    document.addEventListener('DOMContentLoaded', () => {
        // 专  注专转 (转 专)
        const wordList = [
            "", "专", "", "砖", "", "", "专", "专转", "", "驻",
            "住驻转", "", "砖", "转", "住", "注驻专", "驻爪", "爪驻专", "拽专", "专",
            "砖", "转拽", "", "", "", "转", "", "专", "专", "",
            "注转", "专", "", "", "转", "住", "住", "注", "驻", "爪拽", "拽住",
            "专注", "砖", "转驻", "住" // ,  砖!
        ];

        // 专   拽转 砖 (转 专 注  )
        const dictionary = new Set([...wordList, "", "砖", "转", "", ""]);

        const state = {
            secretWord: wordList[Math.floor(Math.random() * wordList.length)],
            grid: Array(6).fill().map(() => Array(5).fill('')),
            currentRow: 0,
            currentCol: 0,
            isGameOver: false,
        };

        console.log(" 住转 (爪专 拽):", state.secretWord);

        const board = document.getElementById('game-board');
        const keyboard = document.getElementById('keyboard');
        const messageContainer = document.getElementById('message-container');

        function showMessage(message, duration = 1000) {
            messageContainer.textContent = message;
            messageContainer.classList.add('show');
            setTimeout(() => {
                messageContainer.classList.remove('show');
            }, duration);
        }

        function createBoard() {
            for (let i = 0; i < 6; i++) {
                const row = document.createElement('div');
                row.className = 'row';
                for (let j = 0; j < 5; j++) {
                    const tile = document.createElement('div');
                    tile.className = 'tile';
                    row.appendChild(tile);
                }
                board.appendChild(row);
            }
        }

        function createKeyboard() {
            const keys = [
                ['拽', '专', '', '', '', '', '', '驻'],
                ['砖', '', '', '', '注', '', '', '', '', '祝'],
                ['', '住', '', '', '', '', '爪', '转', '抓'],
                ['Enter', '拽']
            ];

            keys.forEach(rowKeys => {
                const row = document.createElement('div');
                row.className = 'keyboard-row';
                rowKeys.forEach(key => {
                    const keyElement = document.createElement('button');
                    keyElement.className = 'key';
                    keyElement.textContent = key;
                    keyElement.setAttribute('data-key', key);
                    if (key === 'Enter' || key === '拽') {
                        keyElement.classList.add('large');
                    }
                    row.appendChild(keyElement);
                });
                keyboard.appendChild(row);
            });
        }

        function handleKeyPress(key) {
            if (state.isGameOver) return;

            if (key === 'Enter') {
                submitGuess();
            } else if (key === '拽' || key === 'Backspace') {
                deleteLetter();
            } else if (state.currentCol < 5 && /^[\u0590-\u05FF]$/.test(key)) { // 拽 专拽 转转 注专转
                addLetter(key);
            }
        }

        function addLetter(letter) {
            const tile = board.children[state.currentRow].children[state.currentCol];
            tile.textContent = letter;
            tile.classList.add('filled', 'pop');
            state.grid[state.currentRow][state.currentCol] = letter;
            state.currentCol++;
        }

        function deleteLetter() {
            if (state.currentCol > 0) {
                state.currentCol--;
                const tile = board.children[state.currentRow].children[state.currentCol];
                tile.textContent = '';
                tile.classList.remove('filled');
                state.grid[state.currentRow][state.currentCol] = '';
            }
        }

        function submitGuess() {
            if (state.currentCol < 5) {
                showMessage("  ");
                return;
            }

            const guess = state.grid[state.currentRow].join('');
            
            // 专住 转拽转,  转 住祝 拽   
            // if (!dictionary.has(guess)) {
            //     showMessage("  专转");
            //     return;
            // }

            flipTiles(guess);
        }
        
        function flipTiles(guess) {
            const rowTiles = board.children[state.currentRow].children;
            const secretLetters = state.secretWord.split('');
            const guessLetters = guess.split('');
            const checked = Array(5).fill(false);
            const keyStatus = {};

            // 砖 1: 转转 转 拽  (专拽)
            for(let i = 0; i < 5; i++) {
                if (guessLetters[i] === secretLetters[i]) {
                    rowTiles[i].dataset.state = 'correct';
                    checked[i] = true;
                    keyStatus[guessLetters[i]] = 'correct';
                }
            }

            // 砖 2: 转转 转 拽   (爪) 转转 砖 拽转 (驻专)
            for(let i = 0; i < 5; i++) {
                if (rowTiles[i].dataset.state) continue; //  注 专拽 砖专 住

                const foundIndex = secretLetters.findIndex((char, index) => char === guessLetters[i] && !checked[index]);
                
                if (foundIndex !== -1) {
                    rowTiles[i].dataset.state = 'present';
                    checked[foundIndex] = true; // 住 转 转  住转 转驻住
                    if (!keyStatus[guessLetters[i]]) {
                        keyStatus[guessLetters[i]] = 'present';
                    }
                } else {
                    rowTiles[i].dataset.state = 'absent';
                    if (!keyStatus[guessLetters[i]]) {
                        keyStatus[guessLetters[i]] = 'absent';
                    }
                }
            }

            // 驻注转 爪 注 拽转
            let delay = 0;
            for (let i = 0; i < 5; i++) {
                const tile = rowTiles[i];
                setTimeout(() => {
                    tile.classList.add('flip');
                    tile.classList.add(tile.dataset.state);
                }, delay);
                delay += 250;
            }

            setTimeout(() => {
                updateKeyboard(keyStatus);
                checkGameEnd(guess);
            }, delay + 250);
        }

        function updateKeyboard(keyStatus) {
            for (const [key, status] of Object.entries(keyStatus)) {
                const keyElement = document.querySelector(`.key[data-key="${key}"]`);
                if (!keyElement) continue;

                // 注 专拽  住住 砖 " 转专"
                const currentStatus = keyElement.classList;
                if (currentStatus.contains('correct')) continue;
                if (currentStatus.contains('present') && status !== 'correct') continue;
                
                keyElement.classList.remove('present', 'absent');
                keyElement.classList.add(status);
            }
        }

        function checkGameEnd(guess) {
            if (guess === state.secretWord) {
                showMessage(" , 住! 爪转 ", 5000);
                state.isGameOver = true;
                return;
            }

            if (state.currentRow === 5) {
                showMessage(`...  转: ${state.secretWord}`, 5000);
                state.isGameOver = true;
                return;
            }

            state.currentRow++;
            state.currentCol = 0;
        }

        function startup() {
            createBoard();
            createKeyboard();

            //  拽拽 注 拽转 专转
            keyboard.addEventListener('click', (e) => {
                if (e.target.matches('.key')) {
                    handleKeyPress(e.target.dataset.key);
                }
            });

            //  拽转 驻转
            document.addEventListener('keydown', (e) => {
                if (e.repeat) return;
                let key = e.key;
                if (key === 'Enter') {
                    handleKeyPress('Enter');
                } else if (key === 'Backspace') {
                    handleKeyPress('拽');
                } else if (/^[\u0590-\u05FF]$/.test(key)) { // 拽  拽  转 注专转
                    handleKeyPress(key);
                }
            });
        }

        startup();
    });
    </script>
</body>
</html>
