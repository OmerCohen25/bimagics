<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BI MAGICS | Your Complete Data-Driven Toolkit</title>
    
    <meta name="description" content="BI MAGICS offers a suite of tools and services to make your organization data-driven. From AI Analysts for teams (Wizards) and automated data governance (Data Agent) to full BI projects.">
    <meta name="keywords" content="AI Data Analyst, Data Agent, Data Catalog, Data Warehouse Optimization, End-to-End BI, Data Analytics, Business Intelligence, Data Automation, Natural Language Query, Self-Service Analytics, Data Governance">
    <meta name="theme-color" content="#0a0a1a">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.bimagics.com/">
    <meta property="og:title" content="BI MAGICS | Your Complete Data-Driven Toolkit">
    <meta property="og:description" content="The AI-powered analytics platform for modern business teams. Ask questions, get answers, make decisions.">
    <meta property="og:image" content="https://www.bimagics.com/og-image.png">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âœ¨</text></svg>">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2EY1HGXGNT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-2EY1HGXGNT');
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Tilt+Neon&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lucide-static@latest/umd/lucide.js"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <style>
        /* General Styles */
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: #0a0a1a; color: #E0E0E0; overflow-x: hidden; }
        #bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        .content-wrapper { position: relative; z-index: 1; }
        .font-tilt-neon { font-family: 'Tilt Neon', sans-serif; }
        .glass-effect { background: rgba(17, 24, 39, 0.6); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .header-scrolled { background: rgba(10, 10, 26, 0.8); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }
        .header-scrolled .h-20 { height: 4.5rem; }

        /* Text & Gradients */
        .neon-text-purple { text-shadow: 0 0 5px #A855F7, 0 0 10px #A855F7, 0 0 15px #c084fc; }
        .neon-text-cyan { text-shadow: 0 0 5px #22D3EE, 0 0 10px #22D3EE, 0 0 15px #67e8f9; }
        .gradient-text { background: linear-gradient(90deg, #A855F7, #22D3EE); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent; }
        
        /* Animations */
        .fade-in-section { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .fade-in-section.is-visible { opacity: 1; transform: translateY(0); }
        .timeline-line { transform: scaleX(0); transform-origin: left; transition: transform 0.8s ease-in-out; }
        .timeline-step { opacity: 0; transition: opacity 0.5s ease-out; }

        /* Specific Component Styles */
        .spellbook-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .spellbook-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.3), 0 0 20px rgba(34, 211, 238, 0.3);
        }
        .data-agent-btn {
            transition: all 0.2s ease-in-out;
        }
        .data-agent-btn.active {
            background-color: #22D3EE;
            color: #0a0a1a;
            box-shadow: 0 0 15px #22D3EE;
        }
    </style>
</head>
<body class="antialiased">

    <canvas id="bg-canvas"></canvas>

    <div class="content-wrapper">
        <header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-20 transition-all duration-300">
                    <a href="#hero" class="flex items-center space-x-2">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-purple-400"><path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        <span class="text-2xl font-bold font-tilt-neon gradient-text">BI MAGICS</span>
                    </a>
                     <nav class="hidden lg:flex items-center space-x-8">
                        <a href="#solutions" class="text-gray-300 hover:text-white transition-colors">Solutions</a>
                        <a href="#wizards" class="text-gray-300 hover:text-white transition-colors">Wizards Demo</a>
                        <a href="#data-agent" class="text-gray-300 hover:text-white transition-colors">Data Agent Demo</a>
                        <a href="#contact" class="text-gray-300 hover:text-white transition-colors">Contact</a>
                    </nav>
                    <div class="flex items-center gap-4">
                        <div class="hidden lg:block">
                            <a href="#contact" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">Let's Talk</a>
                        </div>
                        <div class="lg:hidden">
                            <button id="mobile-menu-button" class="text-white focus:outline-none"><i data-lucide="menu" class="w-6 h-6"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="mobile-menu" class="hidden lg:hidden glass-effect">
                <nav class="px-4 pt-2 pb-4 space-y-1 sm:px-6">
                    <a href="#solutions" class="block text-gray-300 hover:text-white py-2 rounded-md">Solutions</a>
                    <a href="#wizards" class="block text-gray-300 hover:text-white py-2 rounded-md">Wizards Demo</a>
                    <a href="#data-agent" class="block text-gray-300 hover:text-white py-2 rounded-md">Data Agent Demo</a>
                    <a href="#contact" class="block text-gray-300 hover:text-white py-2 rounded-md">Contact</a>
                    <a href="#contact" class="block bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 text-center mt-4">Let's Talk</a>
                </nav>
            </div>
        </header>

        <main class="pt-20">
            <section id="hero" class="py-20 md:py-28 text-center overflow-hidden">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                    <h1 class="text-4xl md:text-6xl lg:text-7xl font-black font-tilt-neon leading-tight gradient-text">
                        Unleash Your Data's Magic
                    </h1>
                    <p class="mt-6 max-w-3xl mx-auto text-lg md:text-xl text-gray-300">
                        Stop the data chaos. BI MAGICS provides a complete suite of tools and services to transform your organization into a data-driven powerhouse, from team-level insights to enterprise-grade governance.
                    </p>
                    <div class="mt-10">
                         <a href="#solutions" class="bg-purple-500 text-white font-bold py-3 px-8 rounded-full transition-all duration-300 transform hover:scale-105 hover:bg-purple-600">
                            Discover Your Solution
                        </a>
                    </div>
                </div>
            </section>

            <section id="solutions" class="py-20 fade-in-section">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-16">
                        <h2 class="text-3xl md:text-5xl font-black font-tilt-neon mb-4">What is Your Data Quest?</h2>
                        <p class="text-lg text-gray-400 max-w-2xl mx-auto">Every data journey is unique. Choose the path that matches your current challenge.</p>
                    </div>
                    <div class="grid md:grid-cols-3 gap-8 lg:gap-12">
                        <a href="#wizards" class="spellbook-card glass-effect rounded-2xl p-8 text-center border-purple-500/50 border-2 block">
                            <div class="flex items-center justify-center h-20 w-20 rounded-full bg-purple-900/50 mb-6 mx-auto"><i data-lucide="wand-2" class="w-10 h-10 text-purple-300"></i></div>
                            <h3 class="text-2xl font-bold font-tilt-neon mb-3">Empower My Team</h3>
                            <p class="text-gray-400">Give business teams a personal AI Analyst to get instant answers from data, no technical skills required.</p>
                        </a>
                        <a href="#data-agent" class="spellbook-card glass-effect rounded-2xl p-8 text-center border-cyan-400/50 border-2 block">
                             <div class="flex items-center justify-center h-20 w-20 rounded-full bg-cyan-900/50 mb-6 mx-auto"><i data-lucide="book-marked" class="w-10 h-10 text-cyan-300"></i></div>
                            <h3 class="text-2xl font-bold font-tilt-neon mb-3">Govern My Data</h3>
                            <p class="text-gray-400">Automatically map, document, monitor, and optimize our data warehouse for the data teams.</p>
                        </a>
                        <a href="#e2e-projects" class="spellbook-card glass-effect rounded-2xl p-8 text-center border-gray-500/50 border-2 block">
                             <div class="flex items-center justify-center h-20 w-20 rounded-full bg-gray-900/50 mb-6 mx-auto"><i data-lucide="gem" class="w-10 h-10 text-gray-300"></i></div>
                            <h3 class="text-2xl font-bold font-tilt-neon mb-3">Build My Foundation</h3>
                            <p class="text-gray-400">We don't have a data infrastructure. We need an expert partner to build our BI system from scratch.</p>
                        </a>
                    </div>
                </div>
            </section>

            <section id="wizards" class="py-24 bg-purple-900/10 fade-in-section">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 grid lg:grid-cols-2 gap-12 items-center">
                    <div>
                        <h2 class="text-4xl md:text-5xl font-black font-tilt-neon mb-4"><span class="neon-text-purple">Wizards:</span> An AI Analyst for Every Team</h2>
                        <p class="text-lg text-gray-300 mb-8">Stop the bottleneck. With Wizards, your Marketing, Sales, and Product teams can ask questions in natural language and get immediate, actionable insights. It's true self-service analytics, finally available to everyone.</p>
                        <a href="https://wizbi.ai" target="_blank" rel="noopener noreferrer" class="bg-purple-500 text-white font-bold py-4 px-8 rounded-full transition-all duration-300 transform hover:scale-105 hover:bg-purple-600 inline-flex items-center gap-2 text-lg">
                            <i data-lucide="external-link" class="w-5 h-5"></i>
                            Try the Live Demo
                        </a>
                    </div>
                    <div class="glass-effect rounded-2xl p-4 border border-purple-500/30">
                        <img src="https://placehold.co/600x400/0a0a1a/e0e0e0?text=Animated+Demo+of+Wizard+UI" alt="Animated demonstration of a user asking a question and receiving a chart as an answer" class="rounded-lg w-full">
                    </div>
                </div>
            </section>
            
            <section id="data-agent" class="py-24 bg-cyan-900/10 fade-in-section">
                 <div class="container mx-auto px-4 sm:px-6 lg:px-8" x-data="dataAgentDemo">
                    <div class="text-center mb-16">
                        <h2 class="text-4xl md:text-5xl font-black font-tilt-neon mb-4"><span class="neon-text-cyan">Data Agent:</span> Your Automated Data Guardian</h2>
                        <p class="text-lg text-gray-300 max-w-3xl mx-auto">For Data Teams: Stop firefighting and start innovating. The Data Agent works 24/7 in your data warehouse to map, monitor, and optimize, giving you a reliable and cost-effective data backend.</p>
                    </div>
                    <div class="grid lg:grid-cols-3 gap-8 items-start">
                        <div class="lg:col-span-1 space-y-4">
                            <button @click="runScript('mapping')" :class="{'active': activeScript === 'mapping'}" class="data-agent-btn w-full text-left glass-effect p-4 rounded-lg border border-cyan-400/50 hover:bg-cyan-400/20">
                                <div class="flex items-center gap-3"><i data-lucide="map" class="w-6 h-6 text-cyan-300"></i><span class="font-bold text-lg">Auto-Catalog & Lineage</span></div>
                                <p class="text-sm text-gray-400 mt-1">See how the agent discovers and documents assets.</p>
                            </button>
                            <button @click="runScript('monitoring')" :class="{'active': activeScript === 'monitoring'}" class="data-agent-btn w-full text-left glass-effect p-4 rounded-lg border border-cyan-400/50 hover:bg-cyan-400/20">
                                <div class="flex items-center gap-3"><i data-lucide="siren" class="w-6 h-6 text-cyan-300"></i><span class="font-bold text-lg">Live Monitoring & Alerts</span></div>
                                <p class="text-sm text-gray-400 mt-1">Watch the agent monitor data health and freshness.</p>
                            </button>
                            <button @click="runScript('optimization')" :class="{'active': activeScript === 'optimization'}" class="data-agent-btn w-full text-left glass-effect p-4 rounded-lg border border-cyan-400/50 hover:bg-cyan-400/20">
                                <div class="flex items-center gap-3"><i data-lucide="zap" class="w-6 h-6 text-cyan-300"></i><span class="font-bold text-lg">Cost & Performance Tuning</span></div>
                                <p class="text-sm text-gray-400 mt-1">Find costly queries and unused tables.</p>
                            </button>
                        </div>
                        <div class="lg:col-span-2 w-full h-[450px] glass-effect rounded-2xl flex flex-col p-1 border-2 border-cyan-400/30">
                             <div class="flex-shrink-0 p-2 border-b border-cyan-800/50 flex items-center justify-between"><div class="flex items-center gap-2"><span class="w-3 h-3 bg-red-500 rounded-full"></span><span class="w-3 h-3 bg-yellow-500 rounded-full"></span><span class="w-3 h-3 bg-green-500 rounded-full"></span></div><div class="text-xs text-cyan-300 font-mono">/var/log/bimagics_agent.log</div></div>
                             <div class="flex-grow p-4 bg-black/20 overflow-y-auto font-mono text-sm" x-ref="logContainer">
                                <template x-for="log in logs" :key="log.id"><p :class="log.color"><span class="text-gray-500" x-text="log.timestamp"></span><span x-text="log.level"></span><span x-html="log.message"></span></p></template>
                                <div x-show="!scriptRunning" class="text-gray-500 flex items-center justify-center h-full">Select a capability to see it in action...</div>
                             </div>
                             <div class="flex-shrink-0 p-2 border-t border-cyan-800/50 text-xs text-gray-400 flex items-center gap-2"><i data-lucide="shield-check" class="w-4 h-4 text-green-400"></i><span>SYSTEM STATUS: <span class="text-green-400 font-bold" x-text="status"></span></span></div>
                        </div>
                    </div>
                 </div>
            </section>
            
            <section id="e2e-projects" class="py-24 bg-gray-900/20 fade-in-section">
                 <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h2 class="text-4xl md:text-5xl font-black font-tilt-neon mb-4">End-to-End BI Projects</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-300">
                        Starting from scratch? We are your strategic data partners. We'll design and build your entire data ecosystem, from raw data pipelines to a culture of data-driven decision-making.
                    </p>

                    <div id="timeline" class="relative mt-16 max-w-4xl mx-auto">
                        <div class="hidden md:block absolute top-1/2 -translate-y-1/2 left-0 right-0 h-1 bg-gray-700">
                            <div class="timeline-line h-1 bg-gradient-to-r from-purple-500 to-cyan-400"></div>
                        </div>
                        <div class="relative grid md:grid-cols-4 gap-8 text-center">
                            <div class="timeline-step flex flex-col items-center">
                                <div class="w-16 h-16 rounded-full bg-gray-800 border-2 border-gray-600 flex items-center justify-center font-bold text-2xl text-gray-400 z-10">1</div>
                                <h4 class="mt-4 font-bold text-lg">Discovery</h4>
                            </div>
                            <div class="timeline-step flex flex-col items-center" style="transition-delay: 200ms;">
                                <div class="w-16 h-16 rounded-full bg-gray-800 border-2 border-gray-600 flex items-center justify-center font-bold text-2xl text-gray-400 z-10">2</div>
                                <h4 class="mt-4 font-bold text-lg">Foundation</h4>
                            </div>
                            <div class="timeline-step flex flex-col items-center" style="transition-delay: 400ms;">
                                <div class="w-16 h-16 rounded-full bg-gray-800 border-2 border-gray-600 flex items-center justify-center font-bold text-2xl text-gray-400 z-10">3</div>
                                <h4 class="mt-4 font-bold text-lg">Integration</h4>
                            </div>
                            <div class="timeline-step flex flex-col items-center" style="transition-delay: 600ms;">
                                <div class="w-16 h-16 rounded-full bg-purple-500 border-2 border-purple-400 flex items-center justify-center font-bold text-2xl text-white z-10">4</div>
                                <h4 class="mt-4 font-bold text-lg text-purple-400">Insights</h4>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-16">
                        <a href="#contact" class="bg-gray-600 text-white font-bold py-4 px-8 rounded-full transition-all duration-300 transform hover:scale-105 hover:bg-gray-700 inline-flex items-center gap-2 text-lg">
                             <i data-lucide="phone" class="w-5 h-5"></i>
                            Let's Build Your Data Future
                        </a>
                    </div>
                </div>
            </section>
            
            <section id="contact" class="py-24 fade-in-section">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="grid lg:grid-cols-2 gap-16 items-center">
                        <div class="max-w-xl">
                           <h2 class="text-3xl font-bold font-tilt-neon mb-4">Ready to Move 10x Faster?</h2>
                           <p class="text-lg text-gray-300 mb-4">
                               Every great data journey starts with a single conversation. Tell us about your challenges, and we'll show you how BI MAGICS can help you achieve your goals.
                           </p>
                        </div>

                        <div class="glass-effect p-8 rounded-2xl" x-data="{ submitted: false }">
                             <template x-if="!submitted">
                                <div x-transition>
                                    <h3 class="text-2xl font-bold mb-6">Schedule a Demo</h3>
                                    <form @submit.prevent="submitted = true">
                                        <div class="space-y-4">
                                            <div class="relative">
                                                <i data-lucide="user" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"></i>
                                                <input type="text" name="name" required class="w-full bg-gray-800 border border-gray-600 rounded-lg pl-10 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Full Name">
                                            </div>
                                            <div class="relative">
                                                <i data-lucide="mail" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"></i>
                                                <input type="email" name="email" required class="w-full bg-gray-800 border border-gray-600 rounded-lg pl-10 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Work Email">
                                            </div>
                                            <div class="relative">
                                                 <i data-lucide="message-square" class="absolute left-3 top-4 w-5 h-5 text-gray-500"></i>
                                                <textarea name="message" rows="3" class="w-full bg-gray-800 border border-gray-600 rounded-lg pl-10 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Tell us about your data challenges..."></textarea>
                                            </div>
                                            <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105">
                                                Request My Demo
                                            </button>
                                        </div>
                                    </form>
                                </div>
                             </template>
                             <template x-if="submitted">
                                 <div class="text-center py-10" x-transition>
                                     <i data-lucide="check-circle-2" class="w-16 h-16 text-green-400 mx-auto mb-4"></i>
                                     <h3 class="text-2xl font-bold mb-2">Thank You!</h3>
                                     <p class="text-gray-300">Your request has been sent. We'll be in touch shortly to schedule your demo.</p>
                                 </div>
                             </template>
                        </div>
                    </div>
                 </div>
            </section>
        </main>

        <footer class="bg-gray-900/50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <div class="text-center text-gray-500">
                    <p>&copy; <span class="year"></span> BI MAGICS. All Spells Reserved.</p>
                     <p class="text-xs mt-2">Crafted with magic in Tel Aviv</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('dataAgentDemo', () => ({
            logs: [],
            status: 'IDLE',
            activeScript: '',
            scriptRunning: false,
            intervalId: null,

            clearPrevious() {
                this.logs = [];
                if (this.intervalId) clearInterval(this.intervalId);
                this.scriptRunning = true;
                this.intervalId = null;
            },

            addLog(log, delay) {
                return new Promise(resolve => {
                    setTimeout(() => {
                        if (this.logs.length > 100) this.logs.shift();
                        this.logs.push({
                            id: Date.now() + Math.random(),
                            timestamp: new Date().toLocaleTimeString(),
                            level: ` ${log.level.padEnd(10)}`,
                            message: ` ${log.message}`,
                            color: log.color
                        });
                        this.$nextTick(() => { this.$refs.logContainer.scrollTop = this.$refs.logContainer.scrollHeight; });
                        resolve();
                    }, delay);
                });
            },
            
            async runScript(scriptName) {
                if (this.scriptRunning && this.activeScript === scriptName) return;
                this.clearPrevious();
                this.activeScript = scriptName;

                const scripts = {
                    mapping: [
                        { level: '[INIT]', message: 'Starting warehouse catalog process...', color: 'text-cyan-400', delay: 100 },
                        { level: '[SCAN]', message: 'Discovering schemas: `prod`, `staging`, `salesforce`...', color: 'text-gray-400', delay: 500 },
                        { level: '[SCAN]', message: 'Found 152 tables, 2014 columns.', color: 'text-gray-400', delay: 500 },
                        { level: '[CATALOG]', message: 'Documenting `prod.fact_orders`... <strong>(AUTO-DETECTED PII in `customer_email`)</strong>', color: 'text-yellow-400', delay: 800 },
                        { level: '[CATALOG]', message: 'Documenting `prod.dim_users`...', color: 'text-gray-400', delay: 500 },
                        { level: '[LINEAGE]', message: 'Mapping dependencies for `prod.rpt_monthly_revenue`...', color: 'text-gray-400', delay: 800 },
                        { level: '[LINEAGE]', message: '`fact_orders` -> `stg_payments` -> `rpt_monthly_revenue`', color: 'text-purple-400', delay: 500 },
                        { level: '[OK]', message: 'Catalog process complete. <strong>View Data Map.</strong>', color: 'text-green-400', delay: 1000 }
                    ],
                    monitoring: [
                        { level: '[INIT]', message: 'Live monitoring activated. Waiting for events...', color: 'text-cyan-400', delay: 100 },
                    ],
                    optimization: [
                        { level: '[INIT]', message: 'Starting cost & performance analysis...', color: 'text-cyan-400', delay: 100 },
                        { level: '[SCAN]', message: 'Analyzing query history for past 30 days...', color: 'text-gray-400', delay: 800 },
                        { level: '[COST]', message: '<strong>High-Cost Query Detected!</strong> ID: `q_xyz789`, Cost: $127.50, User: `analyst@bi.com`', color: 'text-red-500', delay: 1200 },
                        { level: '[PERF]', message: 'Suggestion: Add partitioning key `created_at` to table `events_log`. Est. savings: $500/mo', color: 'text-yellow-400', delay: 800 },
                        { level: '[SCAN]', message: 'Scanning for unused assets...', color: 'text-gray-400', delay: 1000 },
                        { level: '[UNUSED]', message: 'Table `stg_temp_users_2022` has not been accessed in 180 days.', color: 'text-yellow-400', delay: 800 },
                        { level: '[OK]', message: 'Optimization analysis complete.', color: 'text-green-400', delay: 500 }
                    ]
                };

                this.status = 'RUNNING';
                for (const log of scripts[scriptName]) {
                    await this.addLog(log, log.delay);
                }
                
                if (scriptName === 'monitoring') {
                    this.status = 'LISTENING';
                    const monitorEvents = [
                        { level: '[HEALTH]', message: 'Data freshness check on `fact_orders`: OK (5m ago)', color: 'text-green-400'},
                        { level: '[HEALTH]', message: 'Schema change detected on `stg_users`: new column `last_login_ip`', color: 'text-yellow-400'},
                        { level: '[HEALTH]', message: 'dbt run `hourly_prod_run` completed successfully.', color: 'text-green-400'},
                        { level: '[ALERT]', message: 'Source `salesforce_api` is delayed by 30 minutes.', color: 'text-red-500'},
                    ];
                    let i = 0;
                    this.intervalId = setInterval(() => {
                        this.addLog(monitorEvents[i % monitorEvents.length], 100);
                        i++;
                    }, 3000);
                } else {
                    this.status = 'OK';
                    this.scriptRunning = false;
                }
            }
        }));
    });
    
    const App = {
        init() {
            this.setupMobileMenu();
            this.setupHeaderScroll();
            this.setupIntersectionObserver();
            this.initThreeJSBackground();
            this.updateDynamicContent();
        },

        updateDynamicContent() {
            document.querySelectorAll('.year').forEach(el => el.textContent = new Date().getFullYear());
            lucide.createIcons();
        },

        setupMobileMenu() {
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            
            mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
            
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => mobileMenu.classList.add('hidden'));
            });
        },

        setupHeaderScroll() {
            const header = document.getElementById('header');
            window.addEventListener('scroll', () => {
                header.classList.toggle('header-scrolled', window.scrollY > 50);
            }, { passive: true });
        },
        
        setupIntersectionObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.fade-in-section').forEach(el => observer.observe(el));
            
            const timelineObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const line = entry.target.querySelector('.timeline-line');
                        const steps = entry.target.querySelectorAll('.timeline-step');
                        if (line) line.style.transform = 'scaleX(1)';
                        steps.forEach(step => step.style.opacity = '1');
                        timelineObserver.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });
            
            const timelineEl = document.getElementById('timeline');
            if (timelineEl) timelineObserver.observe(timelineEl);
        },

        initThreeJSBackground() {
            try {
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg-canvas'), alpha: true });
                
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(window.innerWidth, window.innerHeight);
                camera.position.setZ(30);

                const starGeometry = new THREE.BufferGeometry();
                const starCount = 8000;
                const positions = new Float32Array(starCount * 3);
                for (let i = 0; i < starCount * 3; i++) {
                    positions[i] = (Math.random() - 0.5) * 200;
                }
                starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                const starMaterial = new THREE.PointsMaterial({ color: 0xaaaaaa, size: 0.15, transparent: true, blending: THREE.AdditiveBlending });
                const stars = new THREE.Points(starGeometry, starMaterial);
                scene.add(stars);

                let mouseX = 0, mouseY = 0;
                document.addEventListener('mousemove', e => {
                    mouseX = (e.clientX / window.innerWidth) * 2 - 1;
                    mouseY = -(e.clientY / window.innerHeight) * 2 + 1;
                }, { passive: true });

                window.addEventListener('resize', () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                });

                function animate() {
                    requestAnimationFrame(animate);
                    stars.rotation.y += 0.0001;
                    stars.rotation.x += 0.0001;
                    camera.position.x += (mouseX * 5 - camera.position.x) * 0.02;
                    camera.position.y += (mouseY * 5 - camera.position.y) * 0.02;
                    camera.lookAt(scene.position);
                    renderer.render(scene, camera);
                }
                animate();
            } catch (e) {
                console.error("Three.js failed to initialize:", e);
                document.body.style.backgroundColor = '#0a0a1a';
            }
        }
    };

    document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
