<!-- demo/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BI Magics â€¢ Demo</title>

  <!-- 3rd-party libs -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@3.4.0/tsparticles.bundle.min.js" defer></script>

  <!-- main styles -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <canvas id="tsparticles"></canvas>

  <!-- top navigation -->
  <nav class="top-nav">
    <button data-i="0" class="active">Feed</button>
    <button data-i="1">Chat</button>
    <button data-i="2">Connect</button>
    <button data-i="3">Studio</button>
  </nav>

  <!-- views wrapper (sections are injected by the JS modules) -->
  <div id="views" class="views"></div>

  <!-- main / nav logic + view modules -->
  <script type="module">
    import './feed.js';
    import './chat.js';
    import './connectors.js';
    import './studio.js';

    /* particles + AOS once */
    tsParticles.load("tsparticles", {
      particles:{number:{value:25,density:{enable:true,area:800}},
        color:{value:"#ffffff"},links:{enable:true,distance:180,opacity:.08,color:"var(--accent)"},
        move:{enable:true,speed:.6},opacity:{value:{min:.05,max:.25}}},fullScreen:{enable:false}
    });
    AOS.init({once:true,duration:500,offset:40,easing:'ease-out-quad'});

    /* navigation + swipe */
    const wrap=document.getElementById("views");
    const btns=document.querySelectorAll(".top-nav button");
    let cur=0,startX,drag=false,winW;
    const go=i=>{
      cur=(i+btns.length)%btns.length;
      wrap.style.transition='transform .45s cubic-bezier(.25,1,.5,1)';
      wrap.style.transform=`translateX(${-100*cur}%)`;
      btns.forEach(b=>b.classList.toggle('active',+b.dataset.i===cur));
    };
    btns.forEach(b=>b.onclick=()=>go(+b.dataset.i));

    const down=e=>{
      if(e.target.closest('button,a,canvas,table'))return;
      startX=e.pageX||e.touches[0].pageX;drag=true;winW=innerWidth;
      wrap.style.transition='none';
    };
    const move=e=>{
      if(!drag)return;
      const x=e.pageX||e.touches[0].pageX;
      wrap.style.transform=`translateX(${ -cur*winW + (x-startX) }px)`;
    };
    const up=e=>{
      if(!drag)return;drag=false;
      const dx=(e.pageX||e.changedTouches[0].pageX)-startX,thr=winW*0.2;
      if(dx<-thr&&cur<btns.length-1)go(cur+1);
      else if(dx>thr&&cur>0)go(cur-1);
      else go(cur);
    };
    wrap.addEventListener('pointerdown',down,{passive:true});
    addEventListener('pointermove',move,{passive:true});
    addEventListener('pointerup',up);
    addEventListener('pointercancel',up);
  </script>
</body>
</html>
