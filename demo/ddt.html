<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Data Tapestry | Turn Your Warehouse Into a Teammate</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-bg: #000000;
            --color-primary: #00F9B8;
            --color-secondary: #7E7FFF;
            --color-text: #EAEAEA;
            --color-text-muted: #888888;
            --color-surface: #111111;
            --color-border: #222222;
            --glow-primary: 0 0 15px 5px rgba(0, 249, 184, 0.3);
            --glow-secondary: 0 0 15px 5px rgba(126, 127, 255, 0.3);
        }

        /* --- Basic Setup --- */
        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: 'Inter', sans-serif;
            margin: 0;
            overflow-x: hidden;
        }

        /* --- Layout & Typography --- */
        .container {
            width: 90%;
            max-width: 1100px;
            margin: 0 auto;
            padding: 120px 0;
            text-align: center;
        }
        section {
            border-bottom: 1px solid var(--color-border);
        }
        h1, h2, h3 { font-weight: 900; letter-spacing: -0.02em; }
        h1 { font-size: 4.5rem; color: #fff; margin-bottom: 2rem; line-height: 1.1; }
        h1 span.highlight { color: var(--color-primary); }
        h2 { font-size: 3rem; color: #fff; margin-bottom: 1.5rem; }
        p { font-size: 1.25rem; line-height: 1.6; color: var(--color-text-muted); max-width: 750px; margin: 0 auto 2rem auto; }
        .button {
            display: inline-block;
            background-color: var(--color-primary);
            color: #000;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: var(--glow-primary);
        }
        .button:hover { transform: scale(1.05); box-shadow: 0 0 25px 8px rgba(0, 249, 184, 0.4); }

        /* --- Hero Section --- */
        #hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            padding: 0;
            overflow: hidden;
        }
        #hero-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        .hero-content { position: relative; z-index: 1; }
        
        /* --- Problem Section --- */
        .problem-grid {
            display: flex;
            justify-content: space-around;
            gap: 2rem;
            margin-top: 4rem;
        }
        .problem-card {
            background: var(--color-surface);
            padding: 2rem;
            border: 1px solid var(--color-border);
            border-radius: 16px;
            width: 30%;
        }
        .problem-card .icon { font-size: 3rem; margin-bottom: 1rem; }
        .problem-card h3 { font-size: 1.5rem; color: #fff; margin-bottom: 0.5rem; font-weight: 700; }

        /* --- Interactive Demo Section --- */
        #demo { min-height: 100vh; }
        .demo-window {
            background: linear-gradient(145deg, #111, #000);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            text-align: left;
            padding: 1.5rem;
            font-family: 'Roboto Mono', monospace;
            margin-top: 4rem;
            position: relative;
            overflow: hidden;
        }
        .window-header {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }
        .window-dot { width: 12px; height: 12px; border-radius: 50%; }
        .window-dot.red { background: #ff5f56; }
        .window-dot.yellow { background: #ffbd2e; }
        .window-dot.green { background: #27c93f; }
        
        .demo-step {
            display: none; /* Hidden by default */
            padding: 1rem;
            border-left: 3px solid var(--color-border);
            margin-bottom: 2rem;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .demo-step h3 { font-size: 1.2rem; color: var(--color-secondary); font-weight: 700; margin-bottom: 1rem; }
        .demo-step p, .demo-step code { font-size: 1rem; }
        
        code.typing-effect {
            white-space: pre-wrap;
            display: block;
            color: var(--color-text);
        }
        code .sql-keyword { color: var(--color-secondary); }
        code .sql-function { color: var(--color-primary); }
        code .sql-string { color: #F59E0B; }
        
        .demo-button {
            background: var(--color-secondary);
            color: #fff;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            transition: all 0.2s ease;
        }
        .demo-button:hover { filter: brightness(1.2); }
        .demo-button:disabled { background: var(--color-border); cursor: not-allowed; }

        /* --- Features Section --- */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            text-align: left;
            margin-top: 4rem;
        }
        .feature-card {
            background: linear-gradient(to bottom right, var(--color-surface), #1a1a1a);
            padding: 2rem;
            border: 1px solid var(--color-border);
            border-radius: 16px;
        }
        .feature-card h3 { display: flex; align-items: center; gap: 1rem; font-size: 1.5rem; color: #fff; margin-bottom: 1rem; }
        .feature-card .icon { color: var(--color-primary); }

        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 4rem 0;
            border: none;
        }
        footer p { margin-bottom: 1rem; }
    </style>
</head>
<body>

    <header id="hero">
        <canvas id="hero-canvas"></canvas>
        <div class="hero-content">
            <h1>Your Data Warehouse Is About to Start <span class="highlight">Talking.</span></h1>
            <p>Stop searching for data. Stop deciphering cryptic queries.
            The Dynamic Data Tapestry turns your chaotic warehouse into an intelligent teammate you can converse with.</p>
            <a href="#demo" class="button">Witness the Transformation</a>
        </div>
    </header>

    <main>
        <section id="problem">
            <div class="container">
                <h2>The Silent Struggle of Every Data Team.</h2>
                <p>You have petabytes of data, but getting clear answers feels like a monumental task. Sound familiar?</p>
                <div class="problem-grid">
                    <div class="problem-card">
                        <div class="icon">‚ùì</div>
                        <h3>The "What Does This Mean?" Problem</h3>
                        <p>Hours lost deciphering columns like `tr_fin_v2_final` and untangling decade-old business logic.</p>
                    </div>
                    <div class="problem-card">
                        <div class="icon">üîç</div>
                        <h3>The Endless Search</h3>
                        <p>Hunting through hundreds of tables and views to find the one true source of data for your analysis.</p>
                    </div>
                    <div class="problem-card">
                        <div class="icon">üíî</div>
                        <h3>The Trust Deficit</h3>
                        <p>Lack of confidence in data leads to duplicated efforts, conflicting reports, and flawed decisions.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="demo">
            <div class="container">
                <h2>From Chaos to Conversation, in 3 Steps.</h2>
                <p>This isn't just another catalog. This is a living, breathing system that learns your data, understands its logic, and speaks your language. Watch it work.</p>
                
                <div class="demo-window">
                    <div class="window-header">
                        <div class="window-dot red"></div>
                        <div class="window-dot yellow"></div>
                        <div class="window-dot green"></div>
                    </div>
                    
                    <div id="demo-content">
                        <div class="demo-step" id="step1" style="display: block;">
                            <h3>Step 1: Connect & Map The Chaos</h3>
                            <p>DDT connects to your warehouse and autonomously traces every table, column, and dependency. No manual input needed.</p>
                            <code class="typing-effect">> DDT.connect('acme-corp-data-warehouse')</code>
                            <br><br>
                            <button class="demo-button" id="demo-btn-1" onclick="runStep1()">Initiate Discovery Scan</button>
                        </div>

                        <div class="demo-step" id="step2">
                            <h3>Step 2: Understand & Enrich with AI</h3>
                            <p>It ingests your SQL transformation code and uses an LLM to decipher business logic, calculate lineage, and enrich the catalog with human-readable context.</p>
                            <code class="typing-effect">> DDT.analyze('dbt_models/marts/finance/')</code>
                             <br><br>
                            <button class="demo-button" id="demo-btn-2" onclick="runStep2()">Enrich with Business Logic</button>
                        </div>

                        <div class="demo-step" id="step3">
                            <h3>Step 3: Converse & Create</h3>
                            <p>The magic moment. Ask a complex business question in plain English. DDT consults its intelligent catalog and generates perfect, production-ready SQL.</p>
                            <p><strong>Your Question:</strong></p>
                            <code>"What were the top 3 product categories by revenue from new customers in Germany last quarter?"</code>
                            <br><br>
                            <button class="demo-button" id="demo-btn-3" onclick="runStep3()">Ask DDT & Generate SQL</button>
                        </div>
                        
                        <div class="demo-step" id="result">
                           <h3>DDT's Response:</h3>
                           <p id="result-explanation"></p>
                           <br>
                           <code id="result-sql" class="typing-effect"></code>
                        </div>

                    </div>
                </div>
            </div>
        </section>
        
        <section id="features">
            <div class="container">
                <h2>A New Class of Data Intelligence.</h2>
                <p>The Dynamic Data Tapestry isn't just a tool; it's a foundational layer for a truly data-driven culture.</p>
                <div class="features-grid">
                    <div class="feature-card">
                        <h3>
                            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                            Automated Deep Documentation
                        </h3>
                        <p>Goes beyond column names. DDT extracts complex business rules and multi-level lineage directly from your transformation code, creating documentation that's always in sync.</p>
                    </div>
                    <div class="feature-card">
                        <h3>
                            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                            Governance That Builds Trust
                        </h3>
                        <p>With automated PII detection, certification workflows, and clear data ownership, you can finally build a culture of confidence around your data assets.</p>
                    </div>
                    <div class="feature-card">
                        <h3>
                             <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                            Natural Language Querying
                        </h3>
                        <p>Empower everyone, from junior analysts to executives, to get answers from data. Lower the barrier to entry and accelerate the speed of insight across your organization.</p>
                    </div>
                    <div class="feature-card">
                        <h3>
                           <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 21.25a8.25 8.25 0 1 0-5.4-2.65L2.75 21l3.3-1.6c.4.15.8.25 1.2.3Z"/><path d="M14 17.75a8.25 8.25 0 1 0-5.4-2.65L6.75 19l3.3-1.6c.4.15.8.25 1.2.3Z"/><path d="M12 3v1M3 12h1M5.6 5.6l.7.7M5.6 18.4l.7-.7"/></svg>
                            Intelligent Co-pilot for Developers
                        </h3>
                        <p>DDT acts as a smart assistant for data engineers. It helps debug complex models, understand the impact of changes, and onboard new team members in record time.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <footer id="contact">
            <h2>Ready to Start a Conversation with Your Data?</h2>
            <p>The future of data interaction is here. Stop managing data, and start collaborating with it.</p>
            <a href="#" class="button">Explore the GitHub Repo</a>
        </footer>
    </main>

<script>
// --- Hero Canvas Animation ---
const canvas = document.getElementById('hero-canvas');
const ctx = canvas.getContext('2d');
let particles = [];
let connections = [];
let target = null;

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}

class Particle {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = Math.random() * 2 + 1;
        this.vx = (Math.random() - 0.5) * 0.5;
        this.vy = (Math.random() - 0.5) * 0.5;
        this.baseX = x;
        this.baseY = y;
        this.density = (Math.random() * 30) + 1;
        this.isNode = false;
    }
    update() {
        if (target) {
            let dx = target.x - this.x;
            let dy = target.y - this.y;
            this.x += dx * 0.03;
            this.y += dy * 0.03;
        } else {
            this.x += this.vx;
            this.y += this.vy;
            if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
            if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
        }
    }
    draw() {
        ctx.fillStyle = this.isNode ? 'rgba(0, 249, 184, 1)' : 'rgba(255, 255, 255, 0.5)';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.closePath();
        ctx.fill();
    }
}

function initCanvas() {
    particles = [];
    for (let i = 0; i < 200; i++) {
        particles.push(new Particle(Math.random() * canvas.width, Math.random() * canvas.height));
    }
}

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let i = 0; i < particles.length; i++) {
        particles[i].update();
        particles[i].draw();
    }
    for (const conn of connections) {
        ctx.beginPath();
        ctx.moveTo(conn.p1.x, conn.p1.y);
        ctx.lineTo(conn.p2.x, conn.p2.y);
        ctx.strokeStyle = 'rgba(0, 249, 184, 0.2)';
        ctx.lineWidth = 0.5;
        ctx.stroke();
    }
    requestAnimationFrame(animate);
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();
initCanvas();
animate();

// --- Scroll-based interaction for hero animation ---
const heroSection = document.getElementById('hero');
let isStructured = false;

window.addEventListener('scroll', () => {
    const scrollPosition = window.scrollY;
    if (scrollPosition > heroSection.offsetHeight / 3 && !isStructured) {
        structureParticles();
        isStructured = true;
    } else if (scrollPosition <= heroSection.offsetHeight / 3 && isStructured) {
        destructureParticles();
        isStructured = false;
    }
});

function structureParticles() {
    connections = [];
    const nodeCount = 15;
    const structureRadius = Math.min(canvas.width, canvas.height) * 0.25;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    for (let i = 0; i < particles.length; i++) {
        if (i < nodeCount) {
            const angle = (i / nodeCount) * Math.PI * 2;
            particles[i].targetX = centerX + Math.cos(angle) * structureRadius * (0.5 + Math.random() * 0.5);
            particles[i].targetY = centerY + Math.sin(angle) * structureRadius * (0.5 + Math.random() * 0.5);
            particles[i].isNode = true;
            particles[i].size = 4;
        } else {
            const randomNode = particles[Math.floor(Math.random() * nodeCount)];
            particles[i].targetX = randomNode.targetX + (Math.random() - 0.5) * 100;
            particles[i].targetY = randomNode.targetY + (Math.random() - 0.5) * 100;
            particles[i].isNode = false;
             particles[i].size = 2;
        }
    }
    
    // Create connections
    for(let i=0; i < nodeCount; i++) {
        for(let j=i+1; j < nodeCount; j++) {
            if (Math.random() > 0.6) {
                connections.push({p1: particles[i], p2: particles[j]});
            }
        }
    }
    
    particles.forEach(p => {
        const move = () => {
            let dx = p.targetX - p.x;
            let dy = p.targetY - p.y;
            if (Math.abs(dx) < 0.1 && Math.abs(dy) < 0.1) return;
            p.x += dx * 0.05;
            p.y += dy * 0.05;
            requestAnimationFrame(move);
        };
        move();
    });
}

function destructureParticles() {
    connections = [];
    particles.forEach(p => {
        p.isNode = false;
        p.size = Math.random() * 2 + 1;
        p.vx = (Math.random() - 0.5) * 0.5;
        p.vy = (Math.random() - 0.5) * 0.5;
    });
    
    particles.forEach(p => {
        const move = () => {
            p.x += p.vx;
            p.y += p.vy;
            if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
            if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
        };
        // No need for raf here, the main loop handles it
    });
}

// --- Interactive Demo Logic ---
const demoSteps = document.querySelectorAll('.demo-step');
const demoButtons = document.querySelectorAll('.demo-button');

function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }

async function typeEffect(element, text, speed = 50) {
    element.innerHTML = "";
    for (let i = 0; i < text.length; i++) {
        element.innerHTML += text.charAt(i);
        await sleep(speed);
    }
}

async function runStep1() {
    const btn = document.getElementById('demo-btn-1');
    btn.disabled = true;
    btn.textContent = 'Scanning...';
    await sleep(2000);
    document.getElementById('step1').style.display = 'none';
    document.getElementById('step2').style.display = 'block';
}

async function runStep2() {
    const btn = document.getElementById('demo-btn-2');
    btn.disabled = true;
    btn.textContent = 'Analyzing...';
    await sleep(2500);
    document.getElementById('step2').style.display = 'none';
    document.getElementById('step3').style.display = 'block';
}

async function runStep3() {
    const btn = document.getElementById('demo-btn-3');
    btn.disabled = true;
    btn.textContent = 'Consulting AI...';
    await sleep(3000);
    document.getElementById('step3').style.display = 'none';
    document.getElementById('result').style.display = 'block';

    const explanationEl = document.getElementById('result-explanation');
    const sqlEl = document.getElementById('result-sql');

    const explanationText = "Of course. To find this, I'll join the certified 'sales' and 'customers' tables, filter for customers whose first order was last quarter, isolate sales from Germany, and then group by product category. Here is the optimal query for your warehouse:";
    
    const sqlText = `<span class="sql-keyword">WITH</span> new_customers <span class="sql-keyword">AS</span> (
  <span class="sql-keyword">SELECT</span> customer_id
  <span class="sql-keyword">FROM</span> \`acme-corp.marketing_marts.dim_customers\`
  <span class="sql-keyword">WHERE</span> <span class="sql-function">DATE_TRUNC</span>(first_order_date, QUARTER) = <span class="sql-function">DATE_TRUNC</span>(<span class="sql-function">CURRENT_DATE</span>(), QUARTER) - <span class="sql-keyword">INTERVAL</span> 1 QUARTER
),

sales_data <span class="sql-keyword">AS</span> (
  <span class="sql-keyword">SELECT</span>
    s.product_category,
    s.sale_amount_usd
  <span class="sql-keyword">FROM</span> \`acme-corp.finance_marts.fct_sales\` s
  <span class="sql-keyword">JOIN</span> new_customers nc <span class="sql-keyword">ON</span> s.customer_id = nc.customer_id
  <span class="sql-keyword">WHERE</span> s.customer_country = <span class="sql-string">'DE'</span>
)

<span class="sql-keyword">SELECT</span>
  product_category,
  <span class="sql-function">SUM</span>(sale_amount_usd) <span class="sql-keyword">AS</span> total_revenue
<span class="sql-keyword">FROM</span> sales_data
<span class="sql-keyword">GROUP BY</span> 1
<span class="sql-keyword">ORDER BY</span> 2 <span class="sql-keyword">DESC</span>
<span class="sql-keyword">LIMIT</span> 3;`;
    
    await typeEffect(explanationEl, explanationText, 30);
    sqlEl.innerHTML = sqlText; // Show SQL immediately for impact
}

// --- Reveal on Scroll ---
const sections = document.querySelectorAll('section');
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.style.opacity = 1;
            entry.target.style.transform = 'translateY(0)';
        }
    });
}, { threshold: 0.1 });

sections.forEach(section => {
    section.style.opacity = 0;
    section.style.transform = 'translateY(50px)';
    section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
    observer.observe(section);
});
</script>

</body>
</html>
