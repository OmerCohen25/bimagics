<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>דמו - בוט ווטסאפ ליצירת תמונות</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Heebo', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            direction: rtl;
        }

        .phone-mockup {
            width: 380px;
            height: 800px;
            background-color: #111b21;
            border-radius: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 18px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        .screen {
            background-color: #e5ddd5;
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAABZohJdAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABtSURBVHja7cEBDQAAAMKg909tDwcUAAAAAAB8Dc2AARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARiAARgYgAEA92sDxwTpJ8YAAAAASUVORK5CYII=");
            flex-grow: 1;
            border-radius: 22px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background-color: #008069;
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #ccc;
            margin-left: 15px;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/Google_Gemini_logo.svg/1200px-Google_Gemini_logo.svg.png');
            background-size: cover;
            background-position: center;
        }

        .chat-info {
            flex-grow: 1;
        }
        
        .chat-info .name {
            font-weight: 500;
        }
        
        .chat-info .status {
            font-size: 0.8em;
            opacity: 0.8;
        }

        .chat-window {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .message {
            max-width: 80%;
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            position: relative;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }

        .message.bot {
            background-color: #ffffff;
            align-self: flex-start;
            border-top-left-radius: 0;
        }

        .message.user {
            background-color: #dcf8c6;
            align-self: flex-end;
            border-top-right-radius: 0;
        }
        
        .message img {
            max-width: 100%;
            border-radius: 6px;
            margin-top: 5px;
        }
        
        .image-container {
            position: relative;
            cursor: pointer;
        }
        
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-20deg);
            color: rgba(255, 0, 0, 0.6);
            font-size: 32px;
            font-weight: bold;
            pointer-events: none;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        .pay-button {
            background-color: #25d366;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            display: block;
            text-align: center;
            font-size: 1em;
            transition: background-color 0.2s;
        }

        .pay-button:hover {
            background-color: #128c7e;
        }

        .input-area {
            background-color: #f0f2f5;
            padding: 10px;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            border-top: 1px solid #ddd;
        }

        .input-box {
            flex-grow: 1;
            background-color: white;
            border-radius: 20px;
            padding: 8px 15px;
            border: none;
        }

        .action-button {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            margin: 0 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background-color: #008069;
            color: white;
            font-size: 20px;
        }
        
        .typing-indicator {
            display: none;
            font-style: italic;
            color: #666;
            padding: 5px 0;
        }
    </style>
</head>
<body>

    <div class="phone-mockup">
        <div class="screen">
            <div class="header">
                <div class="avatar"></div>
                <div class="chat-info">
                    <div class="name">בוט התמונות שלי</div>
                    <div class="status">מקוון</div>
                </div>
            </div>
            <div class="chat-window" id="chatWindow">
                </div>
            <div class="input-area">
                <button class="action-button" id="attachBtn" title="צרף תמונה">📎</button>
                <input type="text" class="input-box" id="textInput" placeholder="כתוב הודעה..." readonly>
                <button class="action-button" id="sendBtn" title="שלח">➤</button>
            </div>
        </div>
    </div>

    <script>
        // --- State Management ---
        const gameState = {
            imageCount: 0,
            isPaid: false,
            awaitingImage: false,
            awaitingText: false,
        };

        // --- DOM Elements ---
        const chatWindow = document.getElementById('chatWindow');
        const attachBtn = document.getElementById('attachBtn');
        const sendBtn = document.getElementById('sendBtn');
        const textInput = document.getElementById('textInput');

        // --- Sample Images (Using Placeholders) ---
        const sampleImages = {
            user: "https://images.pexels.com/photos/3225517/pexels-photo-3225517.jpeg?auto=compress&cs=tinysrgb&w=400",
            bot_processed: "https://images.pexels.com/photos/3225517/pexels-photo-3225517.jpeg?auto=compress&cs=tinysrgb&w=400&sat=-100&bri=20",
        };

        // --- Functions ---
        
        function appendMessage(sender, content) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender);
            messageDiv.innerHTML = content;
            chatWindow.appendChild(messageDiv);
            scrollToBottom();
        }

        function scrollToBottom() {
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function showTypingIndicator() {
            let indicator = document.getElementById('typingIndicator');
            if (!indicator) {
                indicator = document.createElement('div');
                indicator.id = 'typingIndicator';
                indicator.classList.add('message', 'bot', 'typing-indicator');
                indicator.textContent = 'הבוט מקליד...';
                chatWindow.appendChild(indicator);
            }
            indicator.style.display = 'block';
            scrollToBottom();
            return indicator;
        }

        function hideTypingIndicator(indicator) {
            if (indicator) {
                indicator.style.display = 'none';
            }
        }
        
        function handleSend() {
            if (!gameState.awaitingText) return;
            
            const userText = textInput.value || "שנה את השמיים לכחולים יותר";
            if(userText) {
                appendMessage('user', userText);
                textInput.value = '';
                gameState.awaitingText = false;
                processBotResponse();
            }
        }
        
        function processBotResponse() {
            const indicator = showTypingIndicator();
            setTimeout(() => {
                hideTypingIndicator(indicator);
                
                if (gameState.imageCount >= 3 && !gameState.isPaid) {
                    // --- Paywall Logic ---
                    appendMessage('bot', `
                        <div class="image-container">
                            <img src="${sampleImages.bot_processed}" alt="Processed Image with Watermark">
                            <div class="watermark">סימן מים</div>
                        </div>
                    `);
                    appendMessage('bot', 'הגעת למגבלה החינמית של 2 תמונות. כדי לקבל את התמונה הזו ללא סימן המים וליצור תמונות נוספות, יש לבצע תשלום.');
                    const payButtonHtml = '<button class="pay-button" id="payBtn">לתשלום מאובטח (10 ₪)</button>';
                    appendMessage('bot', payButtonHtml);
                    document.getElementById('payBtn').addEventListener('click', handlePayment);

                } else {
                    // --- Standard Logic ---
                    appendMessage('bot', `קיבלתי! הנה התמונה שלך:
                        <img src="${sampleImages.bot_processed}" alt="Processed Image">
                    `);
                     if (gameState.imageCount < 3) {
                         appendMessage('bot', `זו התמונה החינמית מספר ${gameState.imageCount} מתוך 2.`);
                     } else {
                         appendMessage('bot', 'תודה שרכשת! אתה יכול להמשיך ליצור.');
                     }
                }
                
                resetInputState();

            }, 2000); // Simulate processing time
        }

        function handlePayment() {
            appendMessage('user', 'ביצוע תשלום...');
            const indicator = showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator(indicator);
                gameState.isPaid = true;
                appendMessage('bot', '✅ תודה רבה! התשלום בוצע בהצלחה.');
                appendMessage('bot', `הנה התמונה שלך ללא סימן המים:
                        <img src="${sampleImages.bot_processed}" alt="Clean Processed Image">
                    `);
                appendMessage('bot', 'עכשיו תוכל להמשיך וליצור כמה תמונות שתרצה. פשוט שלח לי תמונה חדשה והוראה.');
                // Reset counter after payment for a new package
                gameState.imageCount = 0;
            }, 2500); // Simulate payment processing
        }
        
        function handleAttach() {
            if(gameState.awaitingImage) {
                 gameState.imageCount++;
                 appendMessage('user', `
                    <img src="${sampleImages.user}" alt="User Uploaded Image">
                 `);
                 gameState.awaitingImage = false;
                 gameState.awaitingText = true;
                 textInput.placeholder = 'איך תרצה לערוך את התמונה?';
                 textInput.readOnly = false;
                 textInput.focus();
            }
        }
        
        function resetInputState() {
             textInput.placeholder = 'שלח תמונה והודעה...';
             textInput.readOnly = true;
             gameState.awaitingImage = true;
             gameState.awaitingText = false;
        }

        // --- Event Listeners ---
        attachBtn.addEventListener('click', handleAttach);
        sendBtn.addEventListener('click', handleSend);
        textInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleSend();
            }
        });

        // --- Initializing the Demo ---
        function startDemo() {
            const indicator = showTypingIndicator();
            setTimeout(() => {
                hideTypingIndicator(indicator);
                appendMessage('bot', 'שלום! 👋 אני בוט שיכול לערוך לך תמונות.');
                appendMessage('bot', 'פשוט שלח לי תמונה (לחץ על 📎) ואז כתוב לי מה תרצה לשנות בה. שתי התמונות הראשונות הן בחינם להתנסות!');
                resetInputState();
            }, 1500);
        }

        startDemo();
    </script>

</body>
</html>
